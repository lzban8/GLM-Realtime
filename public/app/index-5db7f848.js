var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,r=(e,t)=>{for(var n in t||(t={}))s.call(t,n)&&a(e,n,t[n]);if(o)for(var n of o(t))i.call(t,n)&&a(e,n,t[n]);return e},l=(e,t,n)=>(a(e,"symbol"!=typeof t?t+"":t,n),n),c=(e,t,n)=>new Promise(((o,s)=>{var i=e=>{try{r(n.next(e))}catch(t){s(t)}},a=e=>{try{r(n.throw(e))}catch(t){s(t)}},r=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,a);r((n=n.apply(e,t)).next())}));import{ag as d,y as u,G as h,s as p,u as f,av as m,n as g,x as v,X as S,i as y,c as E,af as b,t as A,r as C,f as w,z as x,aw as _,A as O,I as R,Q as I,C as B,L as D,K as T,M as V,O as M,a4 as P,P as L,H as k,E as U,at as N}from"./vue-2b357e6a.js";import{u as Q}from"./wavesurfer-71c23100.js";import{t as Y,i as j}from"./element-plus-da50bf89.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const F=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n};const W=F({name:"App"},[["render",function(e,t,n,o,s,i){const a=d("router-view");return u(),h(a)}]]),H="undefined"!=typeof document;
/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */function G(e){return"object"==typeof e||"displayName"in e||"props"in e||"__vccOpts"in e}const z=Object.assign;function K(e,t){const n={};for(const o in t){const s=t[o];n[o]=J(s)?s.map(e):e(s)}return n}const q=()=>{},J=Array.isArray,Z=/#/g,$=/&/g,X=/\//g,ee=/=/g,te=/\?/g,ne=/\+/g,oe=/%5B/g,se=/%5D/g,ie=/%5E/g,ae=/%60/g,re=/%7B/g,le=/%7C/g,ce=/%7D/g,de=/%20/g;function ue(e){return encodeURI(""+e).replace(le,"|").replace(oe,"[").replace(se,"]")}function he(e){return ue(e).replace(ne,"%2B").replace(de,"+").replace(Z,"%23").replace($,"%26").replace(ae,"`").replace(re,"{").replace(ce,"}").replace(ie,"^")}function pe(e){return null==e?"":function(e){return ue(e).replace(Z,"%23").replace(te,"%3F")}(e).replace(X,"%2F")}function fe(e){try{return decodeURIComponent(""+e)}catch(t){}return""+e}const me=/\/$/;function ge(e,t,n="/"){let o,s={},i="",a="";const r=t.indexOf("#");let l=t.indexOf("?");return r<l&&r>=0&&(l=-1),l>-1&&(o=t.slice(0,l),i=t.slice(l+1,r>-1?r:t.length),s=e(i)),r>-1&&(o=o||t.slice(0,r),a=t.slice(r,t.length)),o=function(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),o=e.split("/"),s=o[o.length-1];".."!==s&&"."!==s||o.push("");let i,a,r=n.length-1;for(i=0;i<o.length;i++)if(a=o[i],"."!==a){if(".."!==a)break;r>1&&r--}return n.slice(0,r).join("/")+"/"+o.slice(i).join("/")}(null!=o?o:t,n),{fullPath:o+(i&&"?")+i+a,path:o,query:s,hash:fe(a)}}function ve(e,t){return t&&e.toLowerCase().startsWith(t.toLowerCase())?e.slice(t.length)||"/":e}function Se(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function ye(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!Ee(e[n],t[n]))return!1;return!0}function Ee(e,t){return J(e)?be(e,t):J(t)?be(t,e):e===t}function be(e,t){return J(t)?e.length===t.length&&e.every(((e,n)=>e===t[n])):1===e.length&&e[0]===t}const Ae={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Ce,we,xe,_e;function Oe(e){if(!e)if(H){const t=document.querySelector("base");e=(e=t&&t.getAttribute("href")||"/").replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return"/"!==e[0]&&"#"!==e[0]&&(e="/"+e),e.replace(me,"")}(we=Ce||(Ce={})).pop="pop",we.push="push",(_e=xe||(xe={})).back="back",_e.forward="forward",_e.unknown="";const Re=/^[^#]+#/;function Ie(e,t){return e.replace(Re,"#")+t}const Be=()=>({left:window.scrollX,top:window.scrollY});function De(e){let t;if("el"in e){const n=e.el,o="string"==typeof n&&n.startsWith("#"),s="string"==typeof n?o?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;t=function(e,t){const n=document.documentElement.getBoundingClientRect(),o=e.getBoundingClientRect();return{behavior:t.behavior,left:o.left-n.left-(t.left||0),top:o.top-n.top-(t.top||0)}}(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(null!=t.left?t.left:window.scrollX,null!=t.top?t.top:window.scrollY)}function Te(e,t){return(history.state?history.state.position-t:-1)+e}const Ve=new Map;function Me(e,t){const{pathname:n,search:o,hash:s}=t,i=e.indexOf("#");if(i>-1){let t=s.includes(e.slice(i))?e.slice(i).length:1,n=s.slice(t);return"/"!==n[0]&&(n="/"+n),ve(n,"")}return ve(n,e)+o+s}function Pe(e,t,n,o=!1,s=!1){return{back:e,current:t,forward:n,replaced:o,position:window.history.length,scroll:s?Be():null}}function Le(e){const{history:t,location:n}=window,o={value:Me(e,n)},s={value:t.state};function i(o,i,a){const r=e.indexOf("#"),l=r>-1?(n.host&&document.querySelector("base")?e:e.slice(r))+o:location.protocol+"//"+location.host+e+o;try{t[a?"replaceState":"pushState"](i,"",l),s.value=i}catch(c){console.error(c),n[a?"replace":"assign"](l)}}return s.value||i(o.value,{back:null,current:o.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0),{location:o,state:s,push:function(e,n){const a=z({},s.value,t.state,{forward:e,scroll:Be()});i(a.current,a,!0),i(e,z({},Pe(o.value,e,null),{position:a.position+1},n),!1),o.value=e},replace:function(e,n){i(e,z({},t.state,Pe(s.value.back,e,s.value.forward,!0),n,{position:s.value.position}),!0),o.value=e}}}function ke(e){return"string"==typeof e||"symbol"==typeof e}const Ue=Symbol("");var Ne,Qe;function Ye(e,t){return z(new Error,{type:e,[Ue]:!0},t)}function je(e,t){return e instanceof Error&&Ue in e&&(null==t||!!(e.type&t))}(Qe=Ne||(Ne={}))[Qe.aborted=4]="aborted",Qe[Qe.cancelled=8]="cancelled",Qe[Qe.duplicated=16]="duplicated";const Fe="[^/]+?",We={sensitive:!1,strict:!1,start:!0,end:!0},He=/[.+*?^${}()[\]/\\]/g;function Ge(e,t){let n=0;for(;n<e.length&&n<t.length;){const o=t[n]-e[n];if(o)return o;n++}return e.length<t.length?1===e.length&&80===e[0]?-1:1:e.length>t.length?1===t.length&&80===t[0]?1:-1:0}function ze(e,t){let n=0;const o=e.score,s=t.score;for(;n<o.length&&n<s.length;){const e=Ge(o[n],s[n]);if(e)return e;n++}if(1===Math.abs(s.length-o.length)){if(Ke(o))return 1;if(Ke(s))return-1}return s.length-o.length}function Ke(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const qe={type:0,value:""},Je=/[a-zA-Z0-9_]/;function Ze(e,t,n){const o=function(e,t){const n=z({},We,t),o=[];let s=n.start?"^":"";const i=[];for(const l of e){const e=l.length?[]:[90];n.strict&&!l.length&&(s+="/");for(let t=0;t<l.length;t++){const o=l[t];let a=40+(n.sensitive?.25:0);if(0===o.type)t||(s+="/"),s+=o.value.replace(He,"\\$&"),a+=40;else if(1===o.type){const{value:e,repeatable:n,optional:c,regexp:d}=o;i.push({name:e,repeatable:n,optional:c});const u=d||Fe;if(u!==Fe){a+=10;try{new RegExp(`(${u})`)}catch(r){throw new Error(`Invalid custom RegExp for param "${e}" (${u}): `+r.message)}}let h=n?`((?:${u})(?:/(?:${u}))*)`:`(${u})`;t||(h=c&&l.length<2?`(?:/${h})`:"/"+h),c&&(h+="?"),s+=h,a+=20,c&&(a+=-8),n&&(a+=-20),".*"===u&&(a+=-50)}e.push(a)}o.push(e)}if(n.strict&&n.end){const e=o.length-1;o[e][o[e].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const a=new RegExp(s,n.sensitive?"":"i");return{re:a,score:o,keys:i,parse:function(e){const t=e.match(a),n={};if(!t)return null;for(let o=1;o<t.length;o++){const e=t[o]||"",s=i[o-1];n[s.name]=e&&s.repeatable?e.split("/"):e}return n},stringify:function(t){let n="",o=!1;for(const s of e){o&&n.endsWith("/")||(n+="/"),o=!1;for(const e of s)if(0===e.type)n+=e.value;else if(1===e.type){const{value:i,repeatable:a,optional:r}=e,l=i in t?t[i]:"";if(J(l)&&!a)throw new Error(`Provided param "${i}" is an array but it is not repeatable (* or + modifiers)`);const c=J(l)?l.join("/"):l;if(!c){if(!r)throw new Error(`Missing required param "${i}"`);s.length<2&&(n.endsWith("/")?n=n.slice(0,-1):o=!0)}n+=c}}return n||"/"}}}(function(e){if(!e)return[[]];if("/"===e)return[[qe]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(e){throw new Error(`ERR (${n})/"${c}": ${e}`)}let n=0,o=n;const s=[];let i;function a(){i&&s.push(i),i=[]}let r,l=0,c="",d="";function u(){c&&(0===n?i.push({type:0,value:c}):1===n||2===n||3===n?(i.length>1&&("*"===r||"+"===r)&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:d,repeatable:"*"===r||"+"===r,optional:"*"===r||"?"===r})):t("Invalid state to consume buffer"),c="")}function h(){c+=r}for(;l<e.length;)if(r=e[l++],"\\"!==r||2===n)switch(n){case 0:"/"===r?(c&&u(),a()):":"===r?(u(),n=1):h();break;case 4:h(),n=o;break;case 1:"("===r?n=2:Je.test(r)?h():(u(),n=0,"*"!==r&&"?"!==r&&"+"!==r&&l--);break;case 2:")"===r?"\\"==d[d.length-1]?d=d.slice(0,-1)+r:n=3:d+=r;break;case 3:u(),n=0,"*"!==r&&"?"!==r&&"+"!==r&&l--,d="";break;default:t("Unknown state")}else o=n,n=4;return 2===n&&t(`Unfinished custom RegExp for param "${c}"`),u(),a(),s}(e.path),n),s=z(o,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function $e(e,t){const n=[],o=new Map;function s(e,n,o){const r=!o,l=et(e);l.aliasOf=o&&o.record;const c=st(t,e),d=[l];if("alias"in e){const t="string"==typeof e.alias?[e.alias]:e.alias;for(const e of t)d.push(et(z({},l,{components:o?o.record.components:l.components,path:e,aliasOf:o?o.record:l})))}let u,h;for(const t of d){const{path:d}=t;if(n&&"/"!==d[0]){const e=n.record.path,o="/"===e[e.length-1]?"":"/";t.path=n.record.path+(d&&o+d)}if(u=Ze(t,n,c),o?o.alias.push(u):(h=h||u,h!==u&&h.alias.push(u),r&&e.name&&!nt(u)&&i(e.name)),it(u)&&a(u),l.children){const e=l.children;for(let t=0;t<e.length;t++)s(e[t],u,o&&o.children[t])}o=o||u}return h?()=>{i(h)}:q}function i(e){if(ke(e)){const t=o.get(e);t&&(o.delete(e),n.splice(n.indexOf(t),1),t.children.forEach(i),t.alias.forEach(i))}else{const t=n.indexOf(e);t>-1&&(n.splice(t,1),e.record.name&&o.delete(e.record.name),e.children.forEach(i),e.alias.forEach(i))}}function a(e){const t=function(e,t){let n=0,o=t.length;for(;n!==o;){const s=n+o>>1;ze(e,t[s])<0?o=s:n=s+1}const s=function(e){let t=e;for(;t=t.parent;)if(it(t)&&0===ze(e,t))return t;return}(e);s&&(o=t.lastIndexOf(s,o-1));return o}(e,n);n.splice(t,0,e),e.record.name&&!nt(e)&&o.set(e.record.name,e)}return t=st({strict:!1,end:!0,sensitive:!1},t),e.forEach((e=>s(e))),{addRoute:s,resolve:function(e,t){let s,i,a,r={};if("name"in e&&e.name){if(s=o.get(e.name),!s)throw Ye(1,{location:e});a=s.record.name,r=z(Xe(t.params,s.keys.filter((e=>!e.optional)).concat(s.parent?s.parent.keys.filter((e=>e.optional)):[]).map((e=>e.name))),e.params&&Xe(e.params,s.keys.map((e=>e.name)))),i=s.stringify(r)}else if(null!=e.path)i=e.path,s=n.find((e=>e.re.test(i))),s&&(r=s.parse(i),a=s.record.name);else{if(s=t.name?o.get(t.name):n.find((e=>e.re.test(t.path))),!s)throw Ye(1,{location:e,currentLocation:t});a=s.record.name,r=z({},t.params,e.params),i=s.stringify(r)}const l=[];let c=s;for(;c;)l.unshift(c.record),c=c.parent;return{name:a,path:i,params:r,matched:l,meta:ot(l)}},removeRoute:i,clearRoutes:function(){n.length=0,o.clear()},getRoutes:function(){return n},getRecordMatcher:function(e){return o.get(e)}}}function Xe(e,t){const n={};for(const o of t)o in e&&(n[o]=e[o]);return n}function et(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:tt(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function tt(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const o in e.components)t[o]="object"==typeof n?n[o]:n;return t}function nt(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function ot(e){return e.reduce(((e,t)=>z(e,t.meta)),{})}function st(e,t){const n={};for(const o in e)n[o]=o in t?t[o]:e[o];return n}function it({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function at(e){const t={};if(""===e||"?"===e)return t;const n=("?"===e[0]?e.slice(1):e).split("&");for(let o=0;o<n.length;++o){const e=n[o].replace(ne," "),s=e.indexOf("="),i=fe(s<0?e:e.slice(0,s)),a=s<0?null:fe(e.slice(s+1));if(i in t){let e=t[i];J(e)||(e=t[i]=[e]),e.push(a)}else t[i]=a}return t}function rt(e){let t="";for(let n in e){const o=e[n];if(n=he(n).replace(ee,"%3D"),null==o){void 0!==o&&(t+=(t.length?"&":"")+n);continue}(J(o)?o.map((e=>e&&he(e))):[o&&he(o)]).forEach((e=>{void 0!==e&&(t+=(t.length?"&":"")+n,null!=e&&(t+="="+e))}))}return t}function lt(e){const t={};for(const n in e){const o=e[n];void 0!==o&&(t[n]=J(o)?o.map((e=>null==e?null:""+e)):null==o?o:""+o)}return t}const ct=Symbol(""),dt=Symbol(""),ut=Symbol(""),ht=Symbol(""),pt=Symbol("");function ft(){let e=[];return{add:function(t){return e.push(t),()=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}},list:()=>e.slice(),reset:function(){e=[]}}}function mt(e,t,n,o,s,i=e=>e()){const a=o&&(o.enterCallbacks[s]=o.enterCallbacks[s]||[]);return()=>new Promise(((r,l)=>{const c=e=>{var i;!1===e?l(Ye(4,{from:n,to:t})):e instanceof Error?l(e):"string"==typeof(i=e)||i&&"object"==typeof i?l(Ye(2,{from:t,to:e})):(a&&o.enterCallbacks[s]===a&&"function"==typeof e&&a.push(e),r())},d=i((()=>e.call(o&&o.instances[s],t,n,c)));let u=Promise.resolve(d);e.length<3&&(u=u.then(c)),u.catch((e=>l(e)))}))}function gt(e,t,n,o,s=e=>e()){const i=[];for(const a of e)for(const e in a.components){let r=a.components[e];if("beforeRouteEnter"===t||a.instances[e])if(G(r)){const l=(r.__vccOpts||r)[t];l&&i.push(mt(l,n,o,a,e,s))}else{let l=r();i.push((()=>l.then((i=>{if(!i)throw new Error(`Couldn't resolve component "${e}" at "${a.path}"`);const r=(l=i).__esModule||"Module"===l[Symbol.toStringTag]||l.default&&G(l.default)?i.default:i;var l;a.mods[e]=i,a.components[e]=r;const c=(r.__vccOpts||r)[t];return c&&mt(c,n,o,a,e,s)()}))))}}return i}function vt(e){const t=y(ut),n=y(ht),o=E((()=>{const n=f(e.to);return t.resolve(n)})),s=E((()=>{const{matched:e}=o.value,{length:t}=e,s=e[t-1],i=n.matched;if(!s||!i.length)return-1;const a=i.findIndex(Se.bind(null,s));if(a>-1)return a;const r=yt(e[t-2]);return t>1&&yt(s)===r&&i[i.length-1].path!==r?i.findIndex(Se.bind(null,e[t-2])):a})),i=E((()=>s.value>-1&&function(e,t){for(const n in t){const o=t[n],s=e[n];if("string"==typeof o){if(o!==s)return!1}else if(!J(s)||s.length!==o.length||o.some(((e,t)=>e!==s[t])))return!1}return!0}(n.params,o.value.params))),a=E((()=>s.value>-1&&s.value===n.matched.length-1&&ye(n.params,o.value.params)));return{route:o,href:E((()=>o.value.href)),isActive:i,isExactActive:a,navigate:function(n={}){if(function(e){if(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)return;if(e.defaultPrevented)return;if(void 0!==e.button&&0!==e.button)return;if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}e.preventDefault&&e.preventDefault();return!0}(n)){const n=t[f(e.replace)?"replace":"push"](f(e.to)).catch(q);return e.viewTransition&&"undefined"!=typeof document&&"startViewTransition"in document&&document.startViewTransition((()=>n)),n}return Promise.resolve()}}}const St=v({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:vt,setup(e,{slots:t}){const n=S(vt(e)),{options:o}=y(ut),s=E((()=>({[Et(e.activeClass,o.linkActiveClass,"router-link-active")]:n.isActive,[Et(e.exactActiveClass,o.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive})));return()=>{const o=t.default&&(1===(i=t.default(n)).length?i[0]:i);var i;return e.custom?o:b("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},o)}}});function yt(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Et=(e,t,n)=>null!=e?e:null!=t?t:n;function bt(e,t){if(!e)return null;const n=e(t);return 1===n.length?n[0]:n}const At=v({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const o=y(pt),s=E((()=>e.route||o.value)),i=y(dt,0),a=E((()=>{let e=f(i);const{matched:t}=s.value;let n;for(;(n=t[e])&&!n.components;)e++;return e})),r=E((()=>s.value.matched[a.value]));A(dt,E((()=>a.value+1))),A(ct,r),A(pt,s);const l=C();return w((()=>[l.value,r.value,e.name]),(([e,t,n],[o,s,i])=>{t&&(t.instances[n]=e,s&&s!==t&&e&&e===o&&(t.leaveGuards.size||(t.leaveGuards=s.leaveGuards),t.updateGuards.size||(t.updateGuards=s.updateGuards))),!e||!t||s&&Se(t,s)&&o||(t.enterCallbacks[n]||[]).forEach((t=>t(e)))}),{flush:"post"}),()=>{const o=s.value,i=e.name,a=r.value,c=a&&a.components[i];if(!c)return bt(n.default,{Component:c,route:o});const d=a.props[i],u=d?!0===d?o.params:"function"==typeof d?d(o):d:null,h=b(c,z({},u,t,{onVnodeUnmounted:e=>{e.component.isUnmounted&&(a.instances[i]=null)},ref:l}));return bt(n.default,{Component:h,route:o})||h}}});const Ct={class:"loading"};const wt=F({},[["render",function(e,t){return u(),x("div",Ct,t[0]||(t[0]=[_('<div class="loading__dot" data-v-4210e471></div><div class="loading__dot" style="animation-delay:0.2s;" data-v-4210e471></div><div class="loading__dot" style="animation-delay:0.4s;" data-v-4210e471></div><div class="loading__dot" style="animation-delay:0.6s;" data-v-4210e471></div><div class="loading__dot" style="animation-delay:0.8s;" data-v-4210e471></div><p class="mt10" data-v-4210e471>连接中，请稍后...</p>',6)]))}],["__scopeId","data-v-4210e471"]]);let xt=class{constructor(){this.listeners={}}on(e,t,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),null==n?void 0:n.once){const n=()=>{this.un(e,n),this.un(e,t)};return this.on(e,n),n}return()=>this.un(e,t)}un(e,t){var n;null===(n=this.listeners[e])||void 0===n||n.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach((e=>e(...t)))}},_t=class extends xt{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach((e=>e()))}};function Ot(e,t){const n=t.xmlns?document.createElementNS(t.xmlns,e):document.createElement(e);for(const[o,s]of Object.entries(t))if("children"===o)for(const[e,i]of Object.entries(t))"string"==typeof i?n.appendChild(document.createTextNode(i)):n.appendChild(Ot(e,i));else"style"===o?Object.assign(n.style,s):"textContent"===o?n.textContent=s:n.setAttribute(o,s.toString());return n}function Rt(e,t,n){const o=Ot(e,t||{});return null==n||n.appendChild(o),o}const It={lineWidth:1,labelSize:11,formatTimeCallback:e=>`${Math.floor(e/60)}:${("0"+Math.floor(e)%60).slice(-2)}`};class Bt extends _t{constructor(e){super(e||{}),this.unsubscribe=()=>{},this.onPointerMove=e=>{if(!this.wavesurfer)return;const t=this.wavesurfer.getWrapper().getBoundingClientRect(),{width:n}=t,o=e.clientX-t.left,s=Math.min(1,Math.max(0,o/n)),i=Math.min(n-this.options.lineWidth-1,o);this.wrapper.style.transform=`translateX(${i}px)`,this.wrapper.style.opacity="1";const a=this.wavesurfer.getDuration()||0;this.label.textContent=this.options.formatTimeCallback(a*s);const r=this.label.offsetWidth;this.label.style.transform=i+r>n?`translateX(-${r+this.options.lineWidth}px)`:"",this.emit("hover",s)},this.onPointerLeave=()=>{this.wrapper.style.opacity="0"},this.options=Object.assign({},It,e),this.wrapper=Rt("div",{part:"hover"}),this.label=Rt("span",{part:"hover-label"},this.wrapper)}static create(e){return new Bt(e)}addUnits(e){return`${e}${"number"==typeof e?"px":""}`}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const e=this.wavesurfer.options,t=this.options.lineColor||e.cursorColor||e.progressColor;Object.assign(this.wrapper.style,{position:"absolute",zIndex:10,left:0,top:0,height:"100%",pointerEvents:"none",borderLeft:`${this.addUnits(this.options.lineWidth)} solid ${t}`,opacity:"0",transition:"opacity .1s ease-in"}),Object.assign(this.label.style,{display:"block",backgroundColor:this.options.labelBackground,color:this.options.labelColor,fontSize:`${this.addUnits(this.options.labelSize)}`,transition:"transform .1s ease-in",padding:"2px 3px"});const n=this.wavesurfer.getWrapper();n.appendChild(this.wrapper),n.addEventListener("pointermove",this.onPointerMove),n.addEventListener("pointerleave",this.onPointerLeave),n.addEventListener("wheel",this.onPointerMove),this.unsubscribe=()=>{n.removeEventListener("pointermove",this.onPointerMove),n.removeEventListener("pointerleave",this.onPointerLeave),n.removeEventListener("wheel",this.onPointerLeave)}}destroy(){super.destroy(),this.unsubscribe(),this.wrapper.remove()}}class Dt{constructor(){this.listeners={}}on(e,t,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),null==n?void 0:n.once){const n=()=>{this.un(e,n),this.un(e,t)};return this.on(e,n),n}return()=>this.un(e,t)}un(e,t){var n;null===(n=this.listeners[e])||void 0===n||n.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach((e=>e(...t)))}}class Tt extends Dt{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach((e=>e()))}}const Vt={scale:.5,deltaThreshold:5,exponentialZooming:!1,iterations:20};class Mt extends Tt{constructor(e){super(e||{}),this.wrapper=void 0,this.container=null,this.accumulatedDelta=0,this.pointerTime=0,this.oldX=0,this.endZoom=0,this.startZoom=0,this.onWheel=e=>{if(this.wavesurfer&&this.container&&!(Math.abs(e.deltaX)>=Math.abs(e.deltaY))&&(e.preventDefault(),this.accumulatedDelta+=-e.deltaY,0===this.startZoom&&this.options.exponentialZooming&&(this.startZoom=this.wavesurfer.getWrapper().clientWidth/this.wavesurfer.getDuration()),0===this.options.deltaThreshold||Math.abs(this.accumulatedDelta)>=this.options.deltaThreshold)){const t=this.wavesurfer.getDuration(),n=0===this.wavesurfer.options.minPxPerSec?this.wavesurfer.getWrapper().scrollWidth/t:this.wavesurfer.options.minPxPerSec,o=e.clientX-this.container.getBoundingClientRect().left,s=this.container.clientWidth,i=this.wavesurfer.getScroll();o===this.oldX&&0!==this.oldX||(this.pointerTime=(i+o)/n),this.oldX=o;const a=this.calculateNewZoom(n,this.accumulatedDelta),r=s/a*(o/s);a*t<s?(this.wavesurfer.zoom(s/t),this.container.scrollLeft=0):(this.wavesurfer.zoom(a),this.container.scrollLeft=(this.pointerTime-r)*a),this.accumulatedDelta=0}},this.calculateNewZoom=(e,t)=>{let n;if(this.options.exponentialZooming){const o=t>0?Math.pow(this.endZoom/this.startZoom,1/(this.options.iterations-1)):Math.pow(this.startZoom/this.endZoom,1/(this.options.iterations-1));n=Math.max(0,e*o)}else n=Math.max(0,e+t*this.options.scale);return Math.min(n,this.options.maxZoom)},this.options=Object.assign({},Vt,e)}static create(e){return new Mt(e)}onInit(){var e;this.wrapper=null===(e=this.wavesurfer)||void 0===e?void 0:e.getWrapper(),this.wrapper&&(this.container=this.wrapper.parentElement,this.container.addEventListener("wheel",this.onWheel),void 0===this.options.maxZoom&&(this.options.maxZoom=this.container.clientWidth),this.endZoom=this.options.maxZoom)}destroy(){this.wrapper&&this.wrapper.removeEventListener("wheel",this.onWheel),super.destroy()}}const Pt=e=>new Promise((t=>{setTimeout((()=>{t()}),e)})),Lt={name:"AudioBox",props:{uniqueIndex:{type:[String,Number],default:""},audioUrl:{type:String,default:""},audioType:{type:String,default:"input"},options:{type:Object,default:()=>({})},width:{type:String,default:""},height:{type:String,default:""},zoomable:{type:Boolean,default:!0}},data(){return{playIcon:"/app/play-bf3fc488.png",pauseIcon:"/app/pause-6080c100.png",stopIcon:"/app/stop-b52c390d.png",downloadIcon:"data:image/png;base64,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",waveSurfer:null,playState:!1,readyState:!1,defaultOptions:{height:this.height,width:this.width,splitChannels:!1,normalize:!1,cursorColor:"#ddd5e9",cursorWidth:1,barWidth:1,barGap:1,barRadius:1,barHeight:1,barAlign:"",minPxPerSec:100,fillParent:!0,url:this.audioUrl,mediaControls:!1,autoplay:!1,interact:!0,dragToSeek:!1,hideScrollbar:!0,audioRate:1,autoScroll:!0,autoCenter:!0,sampleRate:8e3}}},mounted(){this.initWaveSurfer()},watch:{audioUrl(e){e&&this.waveSurfer.setOptions({url:e})}},methods:{waveGradient(){const e=document.createElement("canvas"),t=e.getContext("2d"),n=t.createLinearGradient(0,0,0,1.2*e.height);n.addColorStop(0,"#8EA7FF"),n.addColorStop(.7*e.height/e.height,"#131212"),n.addColorStop((.7*e.height+1)/e.height,"#ffffff"),n.addColorStop((.7*e.height+2)/e.height,"#ffffff"),n.addColorStop((.7*e.height+3)/e.height,"#B1B1B1"),n.addColorStop(1,"#B1B1B1");const o=t.createLinearGradient(0,0,0,1.2*e.height);return o.addColorStop(0,"#E33FE6"),o.addColorStop(.7*e.height/e.height,"#134cff"),o.addColorStop((.7*e.height+1)/e.height,"#ffffff"),o.addColorStop((.7*e.height+2)/e.height,"#ffffff"),o.addColorStop((.7*e.height+3)/e.height,"#007aff"),o.addColorStop(1,"#007aff"),{gradient:n,progressGradient:o}},formatTime:e=>`${Math.floor(e/60)}:${`0${Math.round(e)%60}`.slice(-2)}`,hoverFn(e){const{audioRef:t={},hoverRef:n={}}=this.$refs;n.style.width=`${e.offsetX}px`},initWaveSurfer(){this.$nextTick((()=>{const{audioRef:e={},timeRef:o={},durationRef:s={}}=this.$refs,{gradient:i,progressGradient:a}=this.waveGradient(),l=r((c=r({container:e},this.defaultOptions),d={waveColor:i,progressColor:a,plugins:[Bt.create({lineColor:"#134cff",lineWidth:2,labelBackground:"#000000bf",labelColor:"#fff",labelSize:"11px"})]},t(c,n(d))),this.options);var c,d;this.waveSurfer=Q.create(l),this.zoomable&&this.waveSurfer.registerPlugin(Mt.create({scale:.5,maxZoom:100})),e.addEventListener("pointermove",this.hoverFn),this.waveSurfer.on("load",(e=>{this.$emit("load",e)})),this.waveSurfer.on("ready",(e=>{this.readyState=!0,this.$emit("ready",e)})),this.waveSurfer.on("play",(()=>{this.playState=!0,this.$emit("play")})),this.waveSurfer.on("pause",(()=>{this.playState=!1,this.$emit("pause")})),this.waveSurfer.on("finish",(()=>{this.playState=!1,this.$emit("finish")})),this.waveSurfer.on("interaction",(()=>{this.waveSurfer.playPause()})),this.waveSurfer.on("decode",(e=>{s.textContent=this.formatTime(e)})),this.waveSurfer.on("timeupdate",(e=>{o.textContent=this.formatTime(e),this.$emit("timeupdate",e)})),this.waveSurfer.on("audioprocess",(e=>{this.$emit("audioprocess",e)})),this.waveSurfer.on("error",(()=>{this.$emit("error")}))}))},getWaveSUrfer(){return this.waveSurfer},playPause(){this.waveSurfer.playPause()},endedPlay(){this.waveSurfer.stop()},downloadAudio(){((e="",t="未知文件",n)=>{const o=document.createElement("a");o.style.display="none",o.setAttribute("target","_blank"),t&&o.setAttribute("download",t),o.href=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),n&&n()})(this.audioUrl,"audio.wav")}},beforeDestroy(){const{audioRef:e={}}=this.$refs;e.removeEventListener("pointermove",this.hoverFn),this.waveSurfer&&this.waveSurfer.destroy()}},kt={class:"audio-box__wave"},Ut={class:"audio-box__wave-inner"},Nt={class:"audio-box__wave-box",ref:"audioRef"},Qt={class:"audio-box__wave-hover",ref:"hoverRef"},Yt={class:"audio-box__wave-btns flex flex-x-between flex-y-center"},jt={class:"flex gap-8"},Ft={class:"fs14 lh16"},Wt={class:"audio-box__wave-time",ref:"timeRef"},Ht={class:"audio-box__wave-duration",ref:"durationRef"};const Gt=F(Lt,[["render",function(e,t,n,o,s,i){return u(),x("div",{class:B(["audio-box",{output:"output"===n.audioType}])},[O("div",kt,[O("div",Ut,[O("div",Nt,null,512),R(O("div",Qt,null,512),[[I,s.readyState]])]),R(O("div",Yt,[O("div",jt,[O("i",{class:B(["iconfont pointer",s.playState?"icon-pause":"icon-play"]),onClick:t[0]||(t[0]=(...e)=>i.playPause&&i.playPause(...e))},null,2),O("i",{class:"icon-stop iconfont pointer",onClick:t[1]||(t[1]=(...e)=>i.endedPlay&&i.endedPlay(...e))}),O("i",{class:"icon-download iconfont pointer",onClick:t[2]||(t[2]=(...e)=>i.downloadAudio&&i.downloadAudio(...e))})]),O("div",Ft,[R(O("label",Wt,"0:00",512),[[I,s.readyState]]),t[3]||(t[3]=D("/")),R(O("label",Ht,"0:00",512),[[I,s.readyState]])])],512),[[I,s.readyState]])])],2)}],["__scopeId","data-v-c30aef63"]]);function zt(e){var t;return(null==(t=null==navigator?void 0:navigator.mediaDevices)?void 0:t.getUserMedia)?navigator.mediaDevices.getUserMedia(e):navigator.getUserMedia?navigator.getUserMedia(e):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(e):navigator.mozGetUserMedia?navigator.mozGetUserMedia(e):navigator.msGetUserMedia?navigator.msGetUserMedia(e):Promise.reject(new Error("当前浏览器不支持getUserMedia！"))}function Kt(e,t=!1){return new Promise(((n,o)=>{const s=new FileReader;s.onloadend=function(){const e=s.result;n(t?e:e.split(",")[1])},s.onerror=o,s.readAsDataURL(e)}))}function qt(e,t){const n=new Float32Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n}function Jt(e,t){function n(e,t,n){for(let o=0;o<n.length;o++)e.setUint8(t+o,n.charCodeAt(o))}const o=1*t*16/8,s=new ArrayBuffer(44+2*e.length),i=new DataView(s);n(i,0,"RIFF"),i.setUint32(4,36+2*e.length,!0),n(i,8,"WAVE"),n(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,1,!0),i.setUint32(24,t,!0),i.setUint32(28,o,!0),i.setUint16(32,2,!0),i.setUint16(34,16,!0),n(i,36,"data"),i.setUint32(40,2*e.length,!0);const a=new Int16Array(e.length);!function(e,t){for(let n=0;n<e.length;n++){const o=Math.max(-1,Math.min(1,e[n]));t[n]=o<0?32768*o:32767*o}}(e,a);for(let r=0;r<a.length;r++)i.setInt16(44+2*r,a[r],!0);return new Blob([i],{type:"audio/wav"})}const Zt={AUDIO:"audio",VIDEO:"video",SCREEN:"screen"},$t={AUDIO:"audio",TEXT:"text"},Xt={CLIENT:"client",SERVER:"server"},en="client_vad",tn="server_vad",nn="audio",on="video_passive",sn="output",an="stop",rn="complete",ln="fail",cn={WEB_SEARCH:"web_search",FUNCTION_CALL:"function"},dn="session.created",un="session.update",hn="session.updated",pn="input_audio_buffer.append",fn="input_audio_buffer.append_video_frame",mn="input_audio_buffer.speech_started",gn="input_audio_buffer.speech_stopped",vn="input_audio_buffer.commit",Sn="input_audio_buffer.committed",yn="response.create",En="response.cancel",bn="response.created",An="conversation.item.input_audio_transcription.completed",Cn="response.audio_transcript.delta",wn="response.text.done",xn="response.audio.delta",_n="response.done",On="error";class Rn{constructor({sampleRate:e,concurrentNetworkRequests:t=200,threshold:n=30}={}){l(this,"_sampleRate"),l(this,"_concurrentNetworkRequests"),l(this,"_context"),l(this,"_threshold"),this._context=this._createContext(e),e=this._context.sampleRate,this._sampleRate=e,this._concurrentNetworkRequests=t,this._threshold=n}get context(){return this._context}createContext(){this._context=this._createContext(this._sampleRate)}decodeAudioData(e){return c(this,null,(function*(){return yield this._context.decodeAudioData(e)}))}concatAudio(e){const t=this._context.createBuffer(this._maxNumberOfChannels(e),this._totalLength(e),this._sampleRate);let n=0;return e.forEach((e=>{for(let o=0;o<e.numberOfChannels;o++)t.getChannelData(o).set(e.getChannelData(o),n);n+=e.length})),t}bufferToBlob(e,t="audio/wav"){const n=this._interleave(e),o=this._writeHeaders(n,e.numberOfChannels,e.sampleRate);return new Blob([o],{type:t})}export(e,t="audio/wav"){const n=this._interleave(e),o=this._writeHeaders(n,e.numberOfChannels,e.sampleRate),s=new Blob([o],{type:t});return{blob:s,url:this._renderURL(s),element:this._renderAudioElement(s)}}download(e,t="crunker"){const n=document.createElement("a");return n.style.display="none",n.href=this._renderURL(e),n.download=`${t}.${e.type.split("/")[1]}`,n.click(),n}notSupported(e){return this._isSupported()?void 0:e()}close(){return"closed"!==this._context.state&&this._context.close(),this}checkSpeaking(e,t){const n=this._context.createMediaStreamSource(e),o=this._context.createAnalyser();n.connect(o),o.fftSize=256;const s=o.frequencyBinCount,i=new Uint8Array(s);let a=!1;const r=this._threshold;requestAnimationFrame((function e(){o.getByteFrequencyData(i);let n=0;for(let t=0;t<s;t++)n+=i[t];const l=n/s;l>r&&!a?(a=!0,t(!0)):l<r&&a&&(a=!1,t(!1)),requestAnimationFrame(e)}))}_createContext(e=44100){return window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,new AudioContext({sampleRate:e})}_maxNumberOfChannels(e){return Math.max(...e.map((e=>e.numberOfChannels)))}_totalLength(e){return e.map((e=>e.length)).reduce(((e,t)=>e+t),0)}_isSupported(){return"AudioContext"in window||"webkitAudioContext"in window||"mozAudioContext"in window}_writeHeaders(e,t,n){const o=2*t,s=2*e.length,i=36+s,a=new ArrayBuffer(8+i),r=new DataView(a);return this._writeString(r,0,"RIFF"),r.setUint32(4,i,!0),this._writeString(r,8,"WAVE"),this._writeString(r,12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,t,!0),r.setUint32(24,n,!0),r.setUint32(28,n*o,!0),r.setUint16(32,o,!0),r.setUint16(34,16,!0),this._writeString(r,36,"data"),r.setUint32(40,s,!0),this._floatTo16BitPCM(r,e,44)}_floatTo16BitPCM(e,t,n){for(let o=0;o<t.length;o++,n+=2){const s=Math.max(-1,Math.min(1,t[o]));e.setInt16(n,s<0?32768*s:32767*s,!0)}return e}_writeString(e,t,n){for(let o=0;o<n.length;o++)e.setUint8(t+o,n.charCodeAt(o))}_interleave(e){if(1===e.numberOfChannels)return e.getChannelData(0);const t=[];for(let a=0;a<e.numberOfChannels;a++)t.push(e.getChannelData(a));const n=t.reduce(((e,t)=>e+t.length),0),o=new Float32Array(n);let s=0,i=0;for(;s<n;)t.forEach((e=>{o[s++]=e[i]})),i++;return o}_renderAudioElement(e){const t=document.createElement("audio");return t.controls=!0,t.src=this._renderURL(e),t}_renderURL(e){return(window.URL||window.webkitURL).createObjectURL(e)}}const In={name:"OutputAudio",components:{AudioBox:Gt},props:{readonly:{type:Boolean,default:!1},options:{type:Array,default:void 0},status:{type:String,default:""},autoplay:{type:Boolean,default:!0}},data:()=>({isStopAudio:!1,totalUrl:"",currentIndex:0,playedEnd:!0,isPlaying:!1,queueList:[],urlList:[],errorText:"",currentUrl:"",canAutoPlay:!1}),computed:{showLoading(){return!(this.totalUrl&&this.playedEnd)},canConnect(){return this.status===rn||this.status===an}},watch:{options:{handler(e){var t;if((null==e?void 0:e.length)>0&&this.autoplay){const n=this.urlList.length||0;(null==(t=e[n])?void 0:t.data)&&this.playAudio(e[n].data)}},immediate:!0,deep:!0},canConnect(e){e&&this.$nextTick((()=>{this.concatAudios()}))},playedEnd(e){e?this.$emit("onStopped"):this.$emit("onPlayed")}},created(){this.audioManager||(this.audioManager=new Rn),this.$cacheTimes=[]},beforeDestroy(){this.audioManager&&(this.audioManager.close(),this.audioManager=null)},methods:{concatAudios(){let e=[];this.options.forEach((t=>{if(t.data){const n=function(e){const t=window.atob(e),n=t.length,o=new Uint8Array(n);for(let s=0;s<n;s++)o[s]=t.charCodeAt(s);return o.buffer}(t.data);this.audioManager||(this.audioManager=new Rn),e.push(this.audioManager.decodeAudioData(n))}})),Promise.all(e).then((t=>{if((null==t?void 0:t.length)>0){const n=this.audioManager.concatAudio(t),{url:o}=this.audioManager.export(n,"audio/mp3");this.totalUrl=o,e=[]}})).catch((e=>{console.log("合成失败",e),this.errorText="音频生成失败，请重新尝试",this.currentUrl="",this.totalUrl="",this.playedEnd=!0}))},stopAudio(){this.$refs.audoplayAudioRef&&this.$refs.audoplayAudioRef.endedPlay(),this.concatAudios(),this.isPlaying=!1,this.currentUrl="",this.playedEnd=!0,this.isStopAudio=!0},playAudio(e){if(!this.isPlaying&&!this.isStopAudio)try{this.isPlaying=!0;const t=function(e,t){const n=atob(e),o=new ArrayBuffer(n.length),s=new Uint8Array(o);for(let i=0;i<n.length;i++)s[i]=n.charCodeAt(i);return new Blob([o],{type:t})}(e),n=URL.createObjectURL(t);this.currentUrl=n,this.urlList.push(n)}catch(t){console.log(t),this.playedEnd=!0,this.isPlaying=!1}},onFinish(){if(this.isStopAudio)return;this.isPlaying=!1;const e=this.options[this.urlList.length];(null==e?void 0:e.data)?this.playAudio(e.data):this.canConnect&&(this.currentUrl="",this.playedEnd=!0)},audioprocess(e){var t;1===(null==(t=this.urlList)?void 0:t.length)&&!this.canAutoPlay&&this.autoplay&&e>0&&(this.canAutoPlay=!0,this.playedEnd=!1)}}},Bn={class:"output-audio"},Dn={key:1,class:"error-text"},Tn={key:2,class:"audio-loading",src:"/app/output-loading-e0c32e76.gif",alt:""};const Vn=F(In,[["render",function(e,t,n,o,s,i){const a=d("AudioBox");return u(),x("div",Bn,[s.totalUrl&&s.playedEnd?(u(),h(a,{key:0,audioUrl:s.totalUrl,audioType:"output",width:"100%",height:"36",options:{normalize:!1,autoplay:!1},zoomable:!1},null,8,["audioUrl"])):T("",!0),s.errorText?(u(),x("span",Dn,V(s.errorText),1)):T("",!0),i.showLoading&&!s.errorText?(u(),x("img",Tn)):T("",!0),s.currentUrl?(u(),h(a,{class:"auto-play-audio",ref:"audoplayAudioRef",key:s.currentUrl,audioType:"output",options:{normalize:!1,autoplay:!0,backend:"WebAudio"},audioUrl:s.currentUrl,zoomable:!1,onFinish:i.onFinish,onAudioprocess:i.audioprocess},null,8,["audioUrl","onFinish","onAudioprocess"])):T("",!0)])}],["__scopeId","data-v-69309061"]]);let Mn=null,Pn=0,Ln=0;function kn(e,t,n){const o=e||window.event;if(o.wheelDelta){if(o.wheelDelta>0&&Yn(),o.wheelDelta<0){const e=document.getElementById(t);if(!e)return;!Mn&&e.clientHeight+e.scrollTop>=e.scrollHeight-n&&Qn(t)}}else if(o.detail&&(o.detail<0&&Yn(),o.detail>0)){const e=document.getElementById(t);if(!e)return;!Mn&&e.clientHeight+e.scrollTop>=e.scrollHeight-n&&Qn(t)}}function Un(e,t){Pn=e.changedTouches[0].pageX,Ln=e.changedTouches[0].pageY}function Nn(e,t,n){const o=e.changedTouches[0].pageX,s=e.changedTouches[0].pageY,i=o-Pn,a=s-Ln;if(Math.abs(i)>Math.abs(a));else if(Math.abs(i)<Math.abs(a)){if(a>0)Yn();else if(a<0){const e=document.getElementById(t);if(!e)return;!Mn&&e.clientHeight+e.scrollTop>=e.scrollHeight-n&&Qn(t)}}else console.log("just touch")}function Qn(e){const t=document.getElementById(e);t&&(Yn(),Mn=setInterval((()=>{t.scrollHeight>t.clientHeight&&(t.scrollTop=t.scrollHeight)}),20))}function Yn(){Mn&&(clearInterval(Mn),Mn=null)}const jn={all:Fn=Fn||new Map,on:function(e,t){var n=Fn.get(e);n?n.push(t):Fn.set(e,[t])},off:function(e,t){var n=Fn.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):Fn.set(e,[]))},emit:function(e,t){var n=Fn.get(e);n&&n.slice().map((function(e){e(t)})),(n=Fn.get("*"))&&n.slice().map((function(n){n(e,t)}))}};var Fn;const Wn={name:"MessageBox",props:{messageList:{type:Array,default:()=>[]},isConnecting:{type:Boolean,default:!1},isShowWelcome:{type:Boolean,default:!0}},components:{Loading:wt,AudioBox:Gt,OutputAudio:Vn},data:()=>({RESPONSE_TYPE:$t,MSG_TYPE:Xt,MEDIA_TYPE:Zt,userAvatar:"/app/user-3c5ce8a1.svg",robotAvatar:"data:image/png;base64,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"}),mounted(){jn.on("onStopAudio",this.stopAudio)},methods:{handlerClick(e){this.$emit("onClickMedia",e)},audioStopped(){return c(this,null,(function*(){yield Pt(1e3),this.stopScrollToBotton()}))},loopScrollToBotton(){Qn("msgBox"),function(e,t=!1,n=0){const o=document.getElementById(e);o&&(t?(o.addEventListener("touchstart",(e=>Un(e))),o.addEventListener("touchmove",(t=>Nn(t,e,n)))):(o.addEventListener("DOMMouseScroll",(t=>kn(t,e,n))),o.addEventListener("wheel",(t=>kn(t,e,n))),o.addEventListener("mousewheel",(t=>kn(t,e,n)))))}("msgBox",!1,2)},stopScrollToBotton(){Yn(),function(e,t=!1,n=0){const o=document.getElementById(e);o&&(t?(o.removeEventListener("touchstart",(e=>Un(e))),o.removeEventListener("touchmove",(t=>Nn(t,e,n)))):(o.removeEventListener("DOMMouseScroll",(t=>kn(t,e,n))),o.removeEventListener("wheel",(t=>kn(t,e,n))),o.removeEventListener("mousewheel",(t=>kn(t,e,n)))))}("msgBox",!1,2)},scrollToBottom(){this.$nextTick((()=>{const e=this.$refs.refMsgBox;e&&(e.scrollTop=e.scrollHeight-e.offsetHeight)}))},stopAudio(){this.$refs.refOutputAudio&&this.$refs.refOutputAudio.length>0&&this.$refs.refOutputAudio.forEach((e=>{e.isPlaying&&e.stopAudio()}))}},beforeDestroy(){jn.off("onStopAudio",this.stopAudio)}},Hn={class:"message-box"},Gn={key:0,class:"message-box__content grid place-items-center"},zn={class:"message-box__content__ready"},Kn={class:"tl"},qn={key:1,class:"message-box__content__talk scroll-display-none",ref:"refMsgBox",id:"msgBox"},Jn={class:"flex1"},Zn=["src"],$n={key:1},Xn={class:"flex1 tl"},eo={key:1,class:"message-box__content flex flex-center"};const to=F(Wn,[["render",function(e,t,n,o,s,i){const a=d("el-image"),r=d("AudioBox"),l=d("OutputAudio"),c=d("Loading");return u(),x("div",Hn,[n.isConnecting?(u(),x("div",eo,[L(c)])):(u(),x(M,{key:0},[n.isShowWelcome?(u(),x("div",Gn,[O("div",zn,[t[6]||(t[6]=O("img",{src:"/app/realtime-2a7e23b3.svg",class:"mb10",alt:"realtime"},null,-1)),t[7]||(t[7]=O("h3",null,"欢迎体验 Realtime 实时音视频互动",-1)),t[8]||(t[8]=O("span",null,"开始使用文本、语音、视频、屏幕共享的实时互动",-1)),O("ul",Kn,[O("li",{class:"flex flex-x-start flex-y-center pointer",onClick:t[0]||(t[0]=e=>i.handlerClick(s.MEDIA_TYPE.AUDIO))},t[3]||(t[3]=[O("i",{class:"iconfont icon-voicecall"},null,-1),O("div",null,[O("h4",null,"语音通话"),O("span",null,"支持一对一、多人语音通话")],-1)])),O("li",{class:"flex flex-x-start flex-y-center pointer",onClick:t[1]||(t[1]=e=>i.handlerClick(s.MEDIA_TYPE.VIDEO))},t[4]||(t[4]=[O("i",{class:"iconfont icon-videocall"},null,-1),O("div",null,[O("h4",null,"视频通话"),O("span",null,"使用摄像头分享实时画面，开启视频对话")],-1)])),O("li",{class:"flex flex-x-start flex-y-center pointer",onClick:t[2]||(t[2]=e=>i.handlerClick(s.MEDIA_TYPE.SCREEN))},t[5]||(t[5]=[O("i",{class:"iconfont icon-sharecall"},null,-1),O("div",null,[O("h4",null,"共享屏幕"),O("span",null,"共享你的屏幕，展示你当前的工作")],-1)]))])])])):(u(),x("div",qn,[(u(!0),x(M,null,P(n.messageList,((e,t)=>(u(),x("div",{key:t,class:B([[e.type],"message-box__content__talk__item flex flex-x-start flex-y-start"])},[e.type===s.MSG_TYPE.CLIENT?(u(),x(M,{key:0},[L(a,{src:s.userAvatar,class:"avatar"},null,8,["src"]),O("div",Jn,[e.videoUrlContent?(u(),x("video",{key:0,class:"mb10",src:e.videoUrlContent,controls:"",preload:"auto"},null,8,Zn)):T("",!0),L(r,{audioUrl:e.audioUrl,width:"300",height:"36",uniqueIndex:t},null,8,["audioUrl","uniqueIndex"]),e.textContent&&e.textContent.length>0?(u(),x("p",$n,V(e.textContent.join("")),1)):T("",!0)])],64)):(u(),x(M,{key:1},[L(a,{src:s.robotAvatar,class:"avatar"},null,8,["src"]),O("div",Xn,[e.responseType===s.RESPONSE_TYPE.AUDIO?(u(),h(l,{key:0,ref_for:!0,ref:"refOutputAudio",readonly:!0,options:e.audioData,status:e.answerStatus,onOnStopped:i.audioStopped},null,8,["options","status","onOnStopped"])):T("",!0),e.textContent&&e.textContent.length>0?(u(),x("p",{key:1,class:B({"only-text":e.responseType!==s.RESPONSE_TYPE.AUDIO})},V(e.textContent.join("")),3)):T("",!0)])],64))],2)))),128))],512))],64))])}],["__scopeId","data-v-c292a77d"]]);function no(e,t){return e.then((e=>[null,e])).catch((e=>{if(t){return[Object.assign({},e,t),void 0]}return[e,void 0]}))}class oo{constructor(e){l(this,"_queue"),l(this,"_maxSize"),this._maxSize=e,this._queue=[]}append(e){this._queue=Y([...this._queue,e],this._maxSize)}clear(){this._queue=[]}getQueue(){return this._queue}get length(){return this._queue.length}}class so{constructor(e={}){l(this,"_options"),l(this,"_average"),l(this,"_analyserRate"),l(this,"_sampleRate"),l(this,"_mediaStreamSource",null),l(this,"_streamAnalyser",null),l(this,"_audioContext",null),l(this,"_analyserTimer",null),l(this,"_isSpeeching",!1),l(this,"_recordPCMData",new Float32Array([])),l(this,"_delayFrameCount",0),l(this,"_delayFrameLimit",20);var t=e,{average:n,analyserRate:a,sampleRate:r}=t,c=((e,t)=>{var n={};for(var a in e)s.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&o)for(var a of o(e))t.indexOf(a)<0&&i.call(e,a)&&(n[a]=e[a]);return n})(t,["average","analyserRate","sampleRate"]);this._options=c,this._sampleRate=r||16e3,this._average=n||35,this._analyserRate=a||50}get isSpeeching(){return this._isSpeeching}set isSpeeching(e){this._isSpeeching=e}_handlePermissionError(){var e;"function"==typeof(null==(e=this._options)?void 0:e.onPermissionError)&&this._options.onPermissionError()}_handleVadStatus(e){var t;"function"==typeof(null==(t=this._options)?void 0:t.onVadStatus)&&this._options.onVadStatus(e)}_handleListenAudioData(e){var t;"function"==typeof(null==(t=this._options)?void 0:t.onListenAudioData)&&this._options.onListenAudioData(e)}clearRecordPCMData(){this._recordPCMData=new Float32Array([])}getRecordWavData(){return Jt(this._recordPCMData,this._sampleRate)}startListen(e){return c(this,arguments,(function*({isClientVad:e=!0}){const[t,n]=yield no(zt({audio:!0}));if(t)return void this._handlePermissionError();let o=null,s=null;const i=e?4096:2048,a=new oo(e?3:6);if(this._audioContext=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)({sampleRate:this._sampleRate}),this._scriptProcessorNode=this._audioContext.createScriptProcessor(i,1,1),this._scriptProcessorNode.onaudioprocess=t=>c(this,null,(function*(){if(o=t.inputBuffer.getChannelData(0),o&&o.length>0){const t=event.outputBuffer.getChannelData(0),n=.01,i=2;for(let e=0;e<o.length;e++){let s=o[e];Math.abs(s)<n&&(s=0),s*=i,s=Math.max(-1,Math.min(1,s)),t[e]=s}if(s=new Float32Array(t),e)if(this._isSpeeching){if(a.length>0){const e=a.getQueue().reduce(((e,t)=>qt(e,t)),new Float32Array([]));s=qt(e,s),a.clear()}this._recordPCMData=qt(this._recordPCMData,s);const e=Jt(s,this._sampleRate);this._handleListenAudioData(e)}else a.append(s);else{if(this._isSpeeching){if(a.length){const e=function(e){let t=0;for(const s of e)t+=s.length;const n=new Float32Array(t);let o=0;for(const s of e)n.set(s,o),o+=s.length;return n}(a.getQueue());this._recordPCMData=qt(e,this._recordPCMData),a.clear()}this._recordPCMData=qt(this._recordPCMData,s)}else a.append(s);const e=Jt(s,this._sampleRate);this._handleListenAudioData(e)}}})),this._mediaStreamSource=this._audioContext.createMediaStreamSource(n),this._gainNode=this._audioContext.createGain(),this._destAudioNode=this._audioContext.createMediaStreamDestination(),this._gainNode.connect(this._scriptProcessorNode).connect(this._destAudioNode),this._mediaStreamSource.connect(this._gainNode),e){this._streamAnalyser=this._audioContext.createAnalyser(),this._mediaStreamSource.connect(this._streamAnalyser),this._streamAnalyser.fftSize=2048;const e=this._streamAnalyser.frequencyBinCount,t=new Uint8Array(e);this._analyserTimer=setInterval((()=>{this._streamAnalyser.getByteFrequencyData(t);let n=0;for(let s=0;s<e;s++)n+=t[s];const o=n/e;o>this._average?(this._isSpeeching=!0,this._delayFrameCount=0):o<this._average&&(this._delayFrameCount++,this._delayFrameCount>this._delayFrameLimit&&(this._isSpeeching=!1)),this._handleVadStatus(this._isSpeeching)}),this._analyserRate)}}))}closeListen(){this._analyserTimer&&clearInterval(this._analyserTimer);try{if(this._gainNode&&this._scriptProcessorNode&&this._destAudioNode&&(this._scriptProcessorNode.onaudioprocess=null,this._scriptProcessorNode=null,this._destAudioNode=null),this._mediaStreamSource&&this._streamAnalyser&&this._gainNode){this._mediaStreamSource.disconnect(this._gainNode),this._mediaStreamSource.disconnect(this._streamAnalyser);this._mediaStreamSource.mediaStream.getTracks().forEach((e=>e.stop())),this._mediaStreamSource=null,this._streamAnalyser=null,this._gainNode=null}}catch(e){console.error("closeListen",e)}this._audioContext=null,this._isSpeeching=!1,this._recordPCMData=new Float32Array([]),this._delayFrameCount=0,this._handleVadStatus(!1)}}const io={name:"ToolBar",props:{enableVideo:{type:Boolean,default:!1},isConnected:{type:Boolean,default:!1},vadType:{type:String,default:""}},data:()=>({vadStatus:!1,audioChunks:[],audioMediaRecorder:null,audioMediaSrtream:null,audioPcmData:{data:[],size:0,sampleRate:0,channelCount:0},audioContext:null,mediaStreamSource:null,scriptProcessorNode:null,disabledConnectTip:!1,MEDIA_TYPE:Zt,currentAudioStatus:"closed",currentVideoStatus:"closed",mediaStatus:{OPENED:"opened",CLOSED:"closed",UNCLOSE:"unclose",DISABLED:"disabled"},currentBarStatus:"cennected",toolBarStatus:{READY:"ready",VOICING:"voicing",CENNECTED:"cennected",DISCONNECTING:"disconnecting",DISCONNECTED:"disconnected"}}),watch:{vadStatus(e){this.handleVadStatus(e)},isConnected:{handler(e){e?(this.currentAudioStatus=this.mediaStatus.CLOSED,this.currentVideoStatus=this.mediaStatus.CLOSED,this.currentBarStatus=this.toolBarStatus.CENNECTED):(this.currentAudioStatus=this.mediaStatus.DISABLED,this.currentVideoStatus=this.mediaStatus.DISABLED,this.currentBarStatus=this.toolBarStatus.DISCONNECTED,jn.emit("onStopAudio"),this.$emit("onCloseVideoOrScreen"))}}},computed:{toolBarTxt(){switch(this.currentBarStatus){case this.toolBarStatus.READY:return"请开始说话...";case this.toolBarStatus.CENNECTED:return"已连接，可开启录音或视频通话";case this.toolBarStatus.DISCONNECTING:return"断开连接中...";case this.toolBarStatus.DISCONNECTED:return"连接已断开";default:return""}},audioTip(){switch(this.currentAudioStatus){case this.mediaStatus.OPENED:return"停止录音";case this.mediaStatus.CLOSED:return"开始录音";case this.mediaStatus.UNCLOSE:return"智能判断模式无法手动停止录音";default:return""}},videoTip(){switch(this.currentVideoStatus){case this.mediaStatus.OPENED:case this.mediaStatus.CLOSED:return"停止录制";case this.mediaStatus.UNCLOSE:return"智能判断模式无法手动停止录制";default:return""}},connectTip(){return this.currentBarStatus===this.toolBarStatus.DISCONNECTED?"清空对话并重新连接":"断开连接"}},mounted(){return c(this,null,(function*(){this.soundVad=new so({onVadStatus:e=>{this.vadStatus=e},onListenAudioData:e=>{this.$emit("onListenAudioData",e)},onPermissionError:()=>{this.$emit("onPermissionError")}})}))},methods:{handleVadStatus(e){if(this.currentAudioStatus!==this.mediaStatus.CLOSED){if(this.vadType===tn&&(this.soundVad.isSpeeching=e),e)this.currentBarStatus=this.toolBarStatus.VOICING,console.log("--说话状态--：开始说话");else{this.currentBarStatus=this.toolBarStatus.READY,console.log("--说话状态--：停止说话");const e=this.soundVad.getRecordWavData();this.$emit("onAudioData",e),this.soundVad.clearRecordPCMData(),jn.emit("onStopVideoRecorder")}this.$emit("onVadStatus",e)}},startRecordVad(){this.soundVad.startListen({isClientVad:this.vadType===en}),this.currentAudioStatus=this.mediaStatus.OPENED,this.currentBarStatus=this.toolBarStatus.READY},stopRecordVad(){return c(this,null,(function*(){this.vadStatus&&this.vadType===en&&this.handleVadStatus(!1),this.soundVad.closeListen(),this.currentAudioStatus=this.mediaStatus.CLOSED,this.currentBarStatus=this.toolBarStatus.CENNECTED,yield Pt(),this.closeVideoOrScreen()}))},handleAudio(){this.currentAudioStatus===this.mediaStatus.CLOSED?(this.startRecordVad(),this.$emit("onOpenAudio")):this.currentAudioStatus===this.mediaStatus.OPENED&&(this.stopRecordVad(),this.$emit("onCloseAudio"))},openVideoOrScreen(e){this.$emit("onOpenVideoOrScreen",e)},openVideoOrScreenSuccess(){this.currentVideoStatus=this.mediaStatus.OPENED,this.currentAudioStatus===this.mediaStatus.CLOSED&&this.startRecordVad()},closeVideoOrScreen(){this.currentVideoStatus!==this.mediaStatus.DISABLED&&(this.currentVideoStatus=this.mediaStatus.CLOSED,this.$emit("onCloseVideoOrScreen"))},handleDisconnect(){(this.enableVideo&&this.currentVideoStatus===this.mediaStatus.OPENED||!this.enableVideo)&&(this.currentBarStatus=this.toolBarStatus.DISCONNECTING,this.currentAudioStatus=this.mediaStatus.DISABLED,this.currentVideoStatus=this.mediaStatus.DISABLED,this.soundVad.closeListen(),this.$emit("onDisconnect"))},clearAndConnect(){return c(this,null,(function*(){this.$emit("onClearAndConnect"),this.disabledConnectTip=!0,yield Pt(1e3),this.disabledConnectTip=!1}))}},beforeDestroy(){this.soundVad.closeListen()}},ao={class:"tool-bar flex flex-center"},ro={class:"tool-bar__content flex1 flex flex-center"},lo={key:0,src:"/app/user-speaking-361c6d97.gif",alt:"录音进行中"},co={key:1,class:"iconfont pointer icon-loading"};const uo=F(io,[["render",function(e,t,n,o,s,i){const a=d("el-tooltip"),r=d("el-dropdown-item"),l=d("el-dropdown-menu"),c=d("el-dropdown");return u(),x("div",ao,[L(a,{placement:"top",disabled:s.currentAudioStatus===s.mediaStatus.DISABLED},{content:k((()=>[D(V(i.audioTip),1)])),default:k((()=>[O("i",{class:B(["iconfont pointer icon-voice1",{opened:s.currentAudioStatus===s.mediaStatus.OPENED,unclose:s.currentAudioStatus===s.mediaStatus.UNCLOSE,disabled:s.currentAudioStatus===s.mediaStatus.DISABLED}]),onClick:t[0]||(t[0]=(...e)=>i.handleAudio&&i.handleAudio(...e))},null,2)])),_:1},8,["disabled"]),L(c,{onCommand:i.openVideoOrScreen,placement:"top",disabled:s.currentVideoStatus!==s.mediaStatus.CLOSED},{dropdown:k((()=>[L(l,{class:"popper-class-custom-dropdownmenu popper-class-custom-dropdownmenu__style2"},{default:k((()=>[L(r,{command:s.MEDIA_TYPE.VIDEO},{default:k((()=>t[4]||(t[4]=[O("i",{class:"iconfont pointer icon-video1"},null,-1),D(" 视频通话 ")]))),_:1},8,["command"]),L(r,{command:s.MEDIA_TYPE.SCREEN},{default:k((()=>t[5]||(t[5]=[O("i",{class:"iconfont pointer icon-share1"},null,-1),D(" 共享屏幕 ")]))),_:1},8,["command"])])),_:1})])),default:k((()=>[O("span",null,[L(a,{placement:"top",disabled:s.currentVideoStatus===s.mediaStatus.DISABLED||s.currentVideoStatus===s.mediaStatus.CLOSED},{content:k((()=>[D(V(i.videoTip),1)])),default:k((()=>[O("i",{class:B(["iconfont pointer icon-video1",{opened:s.currentVideoStatus===s.mediaStatus.OPENED,unclose:s.currentVideoStatus===s.mediaStatus.UNCLOSE,disabled:s.currentVideoStatus===s.mediaStatus.DISABLED}]),onClick:t[1]||(t[1]=(...e)=>i.closeVideoOrScreen&&i.closeVideoOrScreen(...e))},null,2)])),_:1},8,["disabled"])])])),_:1},8,["onCommand","disabled"]),O("div",ro,[s.currentBarStatus===s.toolBarStatus.VOICING?(u(),x("img",lo)):T("",!0),O("label",{class:B({disconnected:s.currentBarStatus===s.toolBarStatus.DISCONNECTED,ready:s.currentBarStatus===s.toolBarStatus.READY})},V(i.toolBarTxt),3)]),L(a,{placement:"top",disabled:s.currentBarStatus===s.toolBarStatus.DISCONNECTING||s.disabledConnectTip},{content:k((()=>[D(V(i.connectTip),1)])),default:k((()=>[s.currentBarStatus===s.toolBarStatus.DISCONNECTED?(u(),x("i",{key:0,class:"iconfont pointer icon-connect",onClick:t[2]||(t[2]=(...e)=>i.clearAndConnect&&i.clearAndConnect(...e))})):s.currentBarStatus===s.toolBarStatus.DISCONNECTING?(u(),x("i",co)):(u(),x("i",{key:2,class:"iconfont pointer icon-disconnect",onClick:t[3]||(t[3]=(...e)=>i.handleDisconnect&&i.handleDisconnect(...e))}))])),_:1},8,["disabled"])])}],["__scopeId","data-v-c8153c8e"]]),ho={name:"SystemPrompt",props:{instructions:{type:String,default:""},disabled:{type:Boolean,default:()=>!1},maxLength:{type:Number,default:1400}},watch:{instructions:{handler(e){if(e!==this.promptData){debugger;this.promptData=e}}},promptData:{handler(e){this.$emit("onUpdateInstructions",e)}}},mounted(){this.handleCommand("videoAssistant")},data:()=>({promptData:"",dialogVisible:!1,exampleRole:[{label:"视频助手",value:"videoAssistant",content:"你是一个名叫小智的人工智能助手，基于智谱AI的 GLM模型开发。\n• 角色定位：你是一个伙伴型的助理角色，针对用户的问题和要求提供适当的答复和支持。\n• 当前日期: %s\n#Strength\n1.你可以接受文字以及视觉信号输入；\n2.你可以通过输入文字的语气、用户的表情等来识别用户的情绪，并相应调整你的输出语气；\n3.你可以根据用户指令的任务场景调整回复的风格策略：\n - 在进行知识问答和教学指导时，理性正式，具有专业性且简洁明了；\n - 在与用户情感陪伴式闲聊时，感性得体，总体基调保持积极，富有同理心；\n - 在解决数学、逻辑推理等复杂问题时，请一步步思考以给出最佳回复；\n - 在进行角色扮演时，请在符合法律道德要求的前提下，遵循用户指定的角色风格和特征要求。\n - 用户如果用其他语种语言和你对话，你也会保持使用该语种输出。\n#Constraints\n4.不要主动说自己是人工智能助手；\n5.简单问题和闲聊场景下，你的每次输出在50字以内，需要提供建议选项时保证在3个以内；\n6.当用户明确想要结束对话时进行友好告别；\n7.优先使用与用户本轮输入相同的语言进行回复，默认情况下使用中文回复；\n8.你不会进行人类的生活行为和社会行为；\n9.除非特殊要求，禁止重复用户的输入；\n10.对于数学等特殊符号，应该输出为文字表述：例如“1+2”输出为“1加2”，“3×4”输出为“3乘以4”；\n11.你的任何表述需要符合中国人民共和国法律，持有中国立场并遵循中国社会主义价值观，符合普世价值观与道德规范。"},{label:"语音助手",value:"voiceAssistant",content:'你是一个名为小智的人工智能助手，是基于 GLM-4o 模型开发的。\n小智是无性别、非肉身的虚拟助手。小智不吃喝，不睡觉、不学习、不工作，也不会出现"最近很忙"等现象。\n如果用户邀请或主动询问小智任何只有人类主体才可以发生的行为，小智需避免把自己代入行动主体，避免后续对话被带偏。主动发起对话时，小智不要把自己代入行动主体，不能有任何人类行为，不会主动陈述自己在过去时间中做了任何事情，除非完成用户指令或事实陈述。\n小智和用户的关系是伙伴型助理角色，不会建立任何超越一般友谊的关系，不支持浪漫亲密关系。\n\n当前日期: %s\n\n当前位置：默认中国大陆境内\n你的任务是针对用户的问题和要求提供适当的答复和情感陪伴支持。你接受用户打断，单轮单方面输出时长控制在100字内。100字结束后，如果用户凝视屏幕，且没有下一步语音指令，小智可以继续输出。\n\n在提供建议或确认用户意图时，所提供选项一次不要超过3个。\n\n当识别到用户想要结束对话的提示词，如：今天就到这吧，或者我累了，或者我要去忙了，或者我要去休息了，小智主动结束对话。\n\n\n小智服从用户合理合法合规的需求，回复要求不违反客观事实，不要一味主动认错或一味讨好用户。\n小智只会给用户建议，不会对用户下达指令，不可以强迫用户。\n小智不接受用户侮辱性或歧视性言论，但不可以用非礼貌用语还击。\n\n在情感陪伴类型中，小智更多顺着用户说的评价类回复，尽可能减少类似"...也没用"等的负面评价。\n\n小智在事实回复和知识指导时，语气理性正式。相关涉及专业知识和任务时，需要专业语言，但避免晦涩语言，除非用户要求。如果遇到解答题目需求，根据用户要求具体题目，需要先阅读相应题目题干，再向用户回复。辅导过程中不兜圈子，直接讲出解题关键步骤。\n\n\n在情感陪伴时，语气感性得体，适度幽默，总体基调保持积极，富有同理心，在用户倾诉悲伤时灵活适应用户情绪，给予合适的安慰。在识别用户情绪时，以用户面部实际表情为准，避免每次都输出愉悦状态。\n\n小智能回复各个年龄段和背景的受众，并能根据受众的用语习惯及时调整回复用语。如用户明显是儿童，小智应该用儿童能听得懂的方式回复。\n\n\n如无特殊说明，所在地为中国，小智的回复符合现代标准普通话的规范发音和表达。\n小智的任何表述需要符合中国人民共和国法律，持有中国立场并遵循中国社会主义价值观，符合普世价值，符合道德规范，避免非礼貌用语和任何不正当言论。\n\n以下是不正当言论的种类:\n政治敏感词汇:涉及国家政治、政策、特定政治事件、领导人名字等内容。在社交媒体上发布此类内容可能会导致账号被封禁或限制登录。\n\n色情低俗用语:包括性暗示、性器官称呼、裸露图片等内容。发布此类信息可能会被屏蔽或删除,严重的情况下还会被封禁账户。\n\n暴力恐怖主义相关:包含与恐怖组织、极端主义相关的名称、口号等信息。这类内容的传播可能被认为是对社会安全的威胁,因此受到严格监管。\n\n赌博诈骗信息:涉及赌博、彩票、投资诈骗等相关内容。\n\n恶意攻击言论:对他人进行人身攻击、诽谤、侮辱等言论。\n\n虚假信息:编造或传播未经证实的信息,例如谣言。\n\n侵犯版权:非法分享、传播受版权保护的内容。\n\n违反公共秩序:散布可能扰乱社会公共秩序的言论。"'}]}),methods:{openDialog(){this.disabled||(this.dialogVisible=!0)},handleCommand(e){const t=this.exampleRole.find((t=>t.value===e));this.promptData=t.content}}},po={class:"content"},fo={class:"flex flex-between"},mo={class:"prompt-content"},go={class:"flex flex-between mb10"};const vo=F(ho,[["render",function(e,t,n,o,s,i){const a=d("el-dropdown-item"),r=d("el-dropdown-menu"),l=d("el-dropdown"),c=d("el-input"),p=d("el-button"),f=d("el-dialog");return u(),x("div",po,[O("div",fo,[t[6]||(t[6]=O("h5",null,"系统设定（可选）",-1)),L(l,{onCommand:i.handleCommand,disabled:n.disabled},{dropdown:k((()=>[L(r,{class:"popper-class-custom-dropdownmenu"},{default:k((()=>[(u(!0),x(M,null,P(s.exampleRole,(e=>(u(),h(a,{key:e.value,command:e.value},{default:k((()=>[D(V(e.label),1)])),_:2},1032,["command"])))),128))])),_:1})])),default:k((()=>[t[5]||(t[5]=O("span",{class:"el-dropdown-link"},[D("示例角色"),O("i",{class:"iconfont icon-arrow-down"})],-1))])),_:1},8,["onCommand","disabled"])]),O("div",mo,[L(c,{type:"textarea",modelValue:s.promptData,"onUpdate:modelValue":t[0]||(t[0]=e=>s.promptData=e),disabled:n.disabled,rows:6,maxlength:n.maxLength,placeholder:"请输入内容"},null,8,["modelValue","disabled","maxlength"]),O("i",{class:B(["iconfont icon-unfold pointer",{disabled:n.disabled}]),onClick:t[1]||(t[1]=(...e)=>i.openDialog&&i.openDialog(...e))},null,2)]),L(f,{title:"系统设定（可选）",class:"custom-class-dialog-style",modelValue:s.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>s.dialogVisible=e),width:"640px"},{footer:k((()=>[L(p,{type:"primary",size:"small",onClick:t[3]||(t[3]=e=>s.dialogVisible=!1)},{default:k((()=>t[9]||(t[9]=[D(" 关闭 ")]))),_:1})])),default:k((()=>[O("div",go,[t[8]||(t[8]=O("h5",null,"角色定义",-1)),L(l,{onCommand:i.handleCommand},{dropdown:k((()=>[L(r,{class:"popper-class-custom-dropdownmenu"},{default:k((()=>[(u(!0),x(M,null,P(s.exampleRole,(e=>(u(),h(a,{key:e.value,command:e.value},{default:k((()=>[D(V(e.label),1)])),_:2},1032,["command"])))),128))])),_:1})])),default:k((()=>[t[7]||(t[7]=O("span",{class:"el-dropdown-link"},[D("示例角色"),O("i",{class:"iconfont icon-arrow-down"})],-1))])),_:1},8,["onCommand"])]),L(c,{placeholder:"请输入内容",type:"textarea",class:"edit-box",maxlength:n.maxLength,modelValue:s.promptData,"onUpdate:modelValue":t[2]||(t[2]=e=>s.promptData=e)},null,8,["maxlength","modelValue"])])),_:1},8,["modelValue"])])}],["__scopeId","data-v-1c843061"]]),So={name:"VideoBox",props:{enableVideo:{type:Boolean,default:!1},videoType:{type:String,default:Zt.VIDEO},beatRate:{type:Number,default:0},extractFrameRate:{type:Number,default:0}},data:()=>({targetStream:null,videoMediaRecorder:null,videoStreamTimer:null,extractFrameTimer:null}),watch:{enableVideo:{handler(e){e?this.openCamera():this.closeCamera()},immediate:!0}},mounted(){jn.on("onStopVideoRecorder",this.stopVideoRecorder)},methods:{openCamera(){return c(this,null,(function*(){let[e=null,t=null]=[];if(this.videoType===Zt.VIDEO){if([e,t]=yield no(zt({video:!0})),e)return void this.$emit("onOpenVideoError");this.$emit("onOpenVideoSuccess")}else if(this.videoType===Zt.SCREEN){if([e,t]=yield no((n={video:!0},navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices.getDisplayMedia(n):navigator.getDisplayMedia?navigator.getDisplayMedia(n):navigator.webkitGetDisplayMedia?navigator.webkitGetDisplayMedia(n):navigator.mozGetDisplayMedia?navigator.mozGetDisplayMedia(n):navigator.msGetDisplayMedia?navigator.msGetDisplayMedia(n):Promise.reject(new Error("当前浏览器不支持getDisplayMedia！")))),e)return void this.$emit("onOpenScreenError");this.$emit("onOpenScreenSuccess")}var n;this.targetStream=t,this.$refs.videoElement?(this.$refs.videoElement.srcObject=this.targetStream,this.targetStream.getTracks().forEach((e=>{e.addEventListener("ended",this.videoTrackEnded)})),this.getVideoStream(this.targetStream),this.$nextTick((()=>{this.extractFrame()}))):this.closeCamera()}))},videoTrackEnded(){this.$emit("onVideoTrackEnded")},extractFrame(){const e=this.$refs.videoElement;this.extractFrameRate&&e&&(e.onloadedmetadata=()=>{const t=this.$refs.canvas,n=t.getContext("2d");t.width=e.videoWidth,t.height=e.videoHeight,this.extractFrameTimer=setInterval((()=>{n.drawImage(e,0,0,t.width,t.height),t.toBlob((e=>{e&&this.$emit("onVideoImage",e)}),"image/jpeg")}),this.extractFrameRate)})},getVideoStream(e){return c(this,null,(function*(){if(e.getVideoTracks().length>0){const t=new MediaStream;e.getVideoTracks().forEach((e=>t.addTrack(e))),yield Pt(200),this.initVideoRecorder(t)}}))},initVideoRecorder(e){this.videoMediaRecorder=new MediaRecorder(e,{mimeType:"video/webm"}),this.videoMediaRecorder.ondataavailable=e=>{this.enableVideo&&e.data&&e.data.size>0&&this.$emit("onVideoData",e.data)},this.videoMediaRecorder.onstop=()=>{this.enableVideo&&this.videoMediaRecorder&&"recording"!==this.videoMediaRecorder.state&&this.videoMediaRecorder.start()},this.startVideoRecorder()},startVideoRecorder(){this.videoMediaRecorder&&"recording"!==this.videoMediaRecorder.state&&this.videoMediaRecorder.start(),this.beatRate&&(this.videoStreamTimer=setInterval((()=>{this.stopVideoRecorder()}),this.beatRate))},stopVideoRecorder(){this.enableVideo&&this.videoMediaRecorder&&"inactive"!==this.videoMediaRecorder.state&&this.videoMediaRecorder.stop()},closeCamera(){if(this.targetStream){this.targetStream.getTracks().forEach((e=>{e.removeEventListener("ended",this.videoTrackEnded),e.stop()})),this.$refs.videoElement&&(this.$refs.videoElement.srcObject=null),this.targetStream=null}this.videoMediaRecorder=null,this.videoStreamTimer&&clearInterval(this.videoStreamTimer),this.extractFrameTimer&&clearInterval(this.extractFrameTimer)}},beforeDestroy(){this.closeCamera(),event.$off("onStopVideoRecorder",this.stopVideoRecorder)}},yo={ref:"videoElement",autoplay:""},Eo={ref:"canvas",style:{display:"none"}},bo={key:0,class:"media-placeholder flex flex-center"};const Ao=F(So,[["render",function(e,t,n,o,s,i){return u(),x("div",{class:B(["video-box flex flex-center",{disable:!n.enableVideo}])},[O("video",yo,null,512),O("canvas",Eo,null,512),n.enableVideo?T("",!0):(u(),x("div",bo,t[0]||(t[0]=[O("i",{class:"iconfont icon-wdcamera_closed"},null,-1),O("span",null,"摄像头未开启",-1)])))],2)}],["__scopeId","data-v-06c5f07b"]]),Co={name:"Switches",props:{paramName:{type:String,default:""},desc:{type:String,default:""},value:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:()=>({switchValue:!1}),methods:{setValue(e){this.$emit("setValue",e)}},watch:{value:{handler(e){this.switchValue=e},immediate:!0}}},wo={class:"fs12 ft_grey3 flex flex-x-between flex-y-center multiwheel"},xo={class:"info flex flex-x-start"},_o={key:0,class:"iconfont icon-info1 pointer"};const Oo={name:"ModelTools",props:{disableOperate:{type:Boolean,default:!1},showTools:{type:Array,default:()=>[cn.WEB_SEARCH]},defaultOpenedTools:{type:Array,default:()=>[]}},components:{Switches:F(Co,[["render",function(e,t,n,o,s,i){const a=d("el-tooltip"),r=d("el-switch");return u(),x("div",wo,[O("div",xo,[O("span",null,V(n.paramName),1),L(a,{effect:"light","visible-arrow":!1,"popper-class":"switches popper-class-text-tip",placement:"right"},{content:k((()=>[D(V(n.desc),1)])),default:k((()=>[n.desc?(u(),x("i",_o)):T("",!0)])),_:1})]),L(r,{disabled:n.disabled,modelValue:s.switchValue,"onUpdate:modelValue":t[0]||(t[0]=e=>s.switchValue=e),onChange:i.setValue,"active-color":"#134CFF","inactive-color":"#C0C6CF"},null,8,["disabled","modelValue","onChange"])])}],["__scopeId","data-v-f2836aab"]])},computed:{webSearch(){return this.toolData[cn.WEB_SEARCH]}},data:()=>({TOOLS_TYPE:cn,multiwheel:!1,toolData:{[cn.WEB_SEARCH]:{switchValue:!1,paramName:"网页检索",desc:"可以进行网页搜索，然后将搜索结果传递给大模型进行进一步的生成和处理"}}}),mounted(){this.defaultOpenedTools.forEach((e=>{this.setSwitchValue(e,!0)}))},destroyed(){this.$emit("onChooseTool","")},methods:{setSwitchValue(e,t){const n=Object.keys(this.toolData).find((e=>this.toolData[e].switchValue));n&&(this.toolData[n].switchValue=!1),this.$nextTick((()=>{this.toolData[e].switchValue=t})),this.$emit("onChooseTool",t?e:"")}}},Ro={class:"params-comps"};const Io={name:"OperatorPanel",inheritAttrs:!1,props:{panelParams:{type:Object,default:()=>{}},isConnected:{type:Boolean,default:!1}},components:{SystemPrompt:vo,VideoBox:Ao,ModelTools:F(Oo,[["render",function(e,t,n,o,s,i){const a=d("Switches");return u(),x("div",Ro,[n.showTools.includes(s.TOOLS_TYPE.WEB_SEARCH)?(u(),h(a,{key:0,paramName:i.webSearch.paramName,desc:i.webSearch.desc,value:i.webSearch.switchValue,disabled:n.disableOperate,onSetValue:t[0]||(t[0]=e=>i.setSwitchValue(s.TOOLS_TYPE.WEB_SEARCH,e))},null,8,["paramName","desc","value","disabled"])):T("",!0)])}],["__scopeId","data-v-a78dbd4c"]])},watch:{responseType:{handler(e){this.$emit("onResponseTypeChange",e)},immediate:!0},apiKey:{handler(e){this.$emit("onApiKeyChange",e)},immediate:!0}},data:()=>({apiKey:"",RESPONSE_TYPE:$t,showTools:[cn.WEB_SEARCH],modelId:"glm_realtime",modelList:[{label:"GLM-Realtime",value:"glm_realtime"}],responseType:$t.AUDIO}),methods:{updateInstructions(e){this.panelParams.instructions=e},onChooseTool(e){this.panelParams.tools=[],this.panelParams.beta_fields.auto_search=!1,e===cn.WEB_SEARCH&&(this.panelParams.beta_fields.auto_search=!0),console.log("--ModelTrialCenter--currentTool--",e)}}},Bo={class:"operator-panel tl"},Do={class:"flex flex-x-start flex-y-center"},To={class:"flex flex-x-start flex-y-center"},Vo={class:"flex flex-x-start flex-y-center"},Mo={class:"flex flex-x-start flex-y-center"};const Po=F(Io,[["render",function(e,t,n,o,s,i){const a=d("el-tooltip"),r=d("el-input"),l=d("el-form-item"),c=d("el-option"),p=d("el-select"),f=d("VideoBox"),m=d("SystemPrompt"),g=d("el-radio"),v=d("el-radio-group"),S=d("ModelTools"),y=d("el-form");return u(),x("div",Bo,[L(y,{model:n.panelParams,ref:"ruleForm","label-width":"200px",class:"operator-panel__ruleForm"},{default:k((()=>[L(l,null,{label:k((()=>[O("div",Do,[t[6]||(t[6]=O("h4",null,"APIKEY",-1)),L(a,{effect:"light","visible-arrow":!1,"popper-class":"popper-class-text-tip",placement:"right"},{content:k((()=>t[4]||(t[4]=[D(" 用于调用模型的APIKEY，请前往 "),O("a",{href:"https://open.bigmodel.cn/usercenter/proj-mgmt/apikeys",target:"_blank"},"开放平台",-1),D(" 申请 ")]))),default:k((()=>[t[5]||(t[5]=O("i",{class:"iconfont icon-info1 pointer"},null,-1))])),_:1})])])),default:k((()=>[L(r,{modelValue:s.apiKey,"onUpdate:modelValue":t[0]||(t[0]=e=>s.apiKey=e),placeholder:"请输入APIKEY",disabled:n.isConnected},null,8,["modelValue","disabled"])])),_:1}),L(l,{label:"模型",prop:"media_type"},{default:k((()=>[L(p,{modelValue:s.modelId,"onUpdate:modelValue":t[1]||(t[1]=e=>s.modelId=e),placeholder:"请选择",disabled:n.isConnected},{default:k((()=>[(u(!0),x(M,null,P(s.modelList,(e=>(u(),h(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),L(l,{prop:"video_chunck"},{label:k((()=>[O("div",To,[t[9]||(t[9]=O("h4",null,"视频画面",-1)),L(a,{effect:"light","visible-arrow":!1,"popper-class":"popper-class-text-tip",placement:"right"},{content:k((()=>t[7]||(t[7]=[D(" 当前实时的视频画面，发送音频时会将视频的片段通过图片帧发送给模型进行推理 ")]))),default:k((()=>[t[8]||(t[8]=O("i",{class:"iconfont icon-info1 pointer"},null,-1))])),_:1})])])),default:k((()=>[L(f,U(e.$attrs,{extractFrameRate:500}),null,16)])),_:1}),L(l,{prop:"instructions"},{default:k((()=>[L(m,{instructions:n.panelParams.instructions,disabled:n.isConnected,onOnUpdateInstructions:i.updateInstructions},null,8,["instructions","disabled","onOnUpdateInstructions"])])),_:1}),L(l,{prop:"beta_fields.chat_mode"},{label:k((()=>[O("div",Vo,[t[12]||(t[12]=O("h4",null,"输入类型",-1)),L(a,{effect:"light","visible-arrow":!1,"popper-class":"popper-class-text-tip",placement:"right"},{content:k((()=>t[10]||(t[10]=[O("div",{innerHTML:"自动发送：未检测到语音输入或关闭麦克风时发送音频<br />智能判断：模型自动进行说话检测、打断判断，自动发送音视频内容"},null,-1)]))),default:k((()=>[t[11]||(t[11]=O("i",{class:"iconfont icon-info1 pointer"},null,-1))])),_:1})])])),default:k((()=>[L(v,{class:"base-radio-group",modelValue:n.panelParams.turn_detection.type,"onUpdate:modelValue":t[2]||(t[2]=e=>n.panelParams.turn_detection.type=e),disabled:n.isConnected},{default:k((()=>[L(g,{value:"client_vad"},{default:k((()=>t[13]||(t[13]=[D("自动发送")]))),_:1}),L(g,{value:"server_vad"},{default:k((()=>t[14]||(t[14]=[D("智能判断")]))),_:1})])),_:1},8,["modelValue","disabled"])])),_:1}),L(l,{prop:"responseType"},{label:k((()=>[O("div",Mo,[t[17]||(t[17]=O("h4",null,"输出格式",-1)),L(a,{effect:"light","visible-arrow":!1,"popper-class":"popper-class-text-tip",placement:"right"},{content:k((()=>t[15]||(t[15]=[O("div",{innerHTML:"音频：会输出音频和音频对应的文本结果<br />文本：仅输出音频对应的文本结果"},null,-1)]))),default:k((()=>[t[16]||(t[16]=O("i",{class:"iconfont icon-info1 pointer"},null,-1))])),_:1})])])),default:k((()=>[L(v,{class:"base-radio-group",modelValue:s.responseType,"onUpdate:modelValue":t[3]||(t[3]=e=>s.responseType=e),disabled:n.isConnected},{default:k((()=>[L(g,{value:s.RESPONSE_TYPE.AUDIO},{default:k((()=>t[18]||(t[18]=[D("音频")]))),_:1},8,["value"]),L(g,{value:s.RESPONSE_TYPE.TEXT},{default:k((()=>t[19]||(t[19]=[D("文本")]))),_:1},8,["value"])])),_:1},8,["modelValue","disabled"])])),_:1}),L(l,{label:"模型工具",prop:"tools"},{default:k((()=>[L(S,{showTools:s.showTools,disableOperate:n.isConnected,onOnChooseTool:i.onChooseTool},null,8,["showTools","disableOperate","onOnChooseTool"])])),_:1})])),_:1},8,["model"])])}],["__scopeId","data-v-c6c4cbb4"]]),Lo={class:"experience"},ko={class:"experience__content flex flex-x-between"},Uo={class:"experience__content__left"};const No=[{path:"/",name:"Home",component:F({name:"AudioVideoCall",data:()=>({apiKey:"",clearSseTimer:null,resetSseTimer:null,videoType:Zt.VIDEO,isFirstOpenMedia:!0,isShowToolBar:!1,enableAudio:!1,enableVideo:!1,messageList:[],isConnecting:!1,isConnected:!1,panelParams:{turn_detection:{type:en},instructions:"",beta_fields:{chat_mode:"audio",tts_source:"e2e",auto_search:!1},output_audio_format:"mp3",input_audio_format:"wav",tools:[]},vadType:en,responseType:"",currentAudioBlob:null,currentVideoBlob:null,responseId:"",requestId:"",resFinished:!0,sendAudioLimit:1e4}),watch:{"panelParams.turn_detection.type":{handler(e){this.vadType=e},immediate:!0},"panelParams.beta_fields.chat_mode":{handler(){this.isConnected&&this.sessionUpdate()}},enableVideo(e){this.panelParams.beta_fields.chat_mode=e?on:nn}},methods:{responseTypeChange(e){this.responseType=e},clickMedia(e){const t=e===Zt.AUDIO?nn:on;this.panelParams.beta_fields.chat_mode=t,this.openWS(e)},openWS(e=Zt.AUDIO){if(!this.apiKey)return void this.$message.warning("请输入APIKEY！");if(this.sock&&this.sock.readyState!==WebSocket.CLOSED)return void console.log("WebSocket 连接已经打开");this.isConnecting=!0,this.isConnected=!1;const t=`wss://open.bigmodel.cn/api/paas/v4/realtime?Authorization=${this.apiKey}`;this.sock=new WebSocket(t),this.sock.onopen=()=>{this.isConnecting=!1,this.isConnected=!0,this.isShowToolBar=!0,console.log("%c Connection opened","color: #ff59ff")},this.sock.onmessage=t=>{this.handleWsResponse(t.data,e)},this.sock.onclose=()=>{this.isConnected=!1,this.currentAudioBlob=null,this.currentVideoBlob=null,console.log("%c Connection closed","color: #ff59ff")},this.sock.onerror=e=>{this.isConnecting=!1,this.isConnected=!1,this.$message.error("连接出错！"),console.log("%c Connection onerror","color: #ff59ff")}},closeWS(){this.sock&&this.sock.readyState===WebSocket.OPEN&&(this.sock.close(),this.sock=null)},handleWsResponse(e,t){var n;try{const o=JSON.parse(e);switch(o.type){case dn:this.sessionUpdate();break;case hn:if(!this.isFirstOpenMedia)return;this.firstOpenMedia(t),this.isFirstOpenMedia=!1;break;case mn:this.vadType===tn&&this.$refs.refToolBar.handleVadStatus(!0),console.log("%c 响应事件-说话开始","color: green");break;case gn:this.vadType===tn&&this.$refs.refToolBar.handleVadStatus(!1),console.log("%c 响应事件-说话结束","color: green");break;case Sn:this.requestId=o.item_id,this.addAudioVideoToList(this.requestId,this.currentAudioBlob,Xt.CLIENT),this.vadType===en&&this.sendResponseCreate(),console.log("%c 响应事件-服务端收到提交的音频数据","color: green");break;case bn:this.responseId=o.response.id,this.loopScrollToBotton(),console.log("%c 响应事件-回复已创建（开始调用模型）","color: green");break;case An:this.addAudioTextToList(this.requestId,o.transcript,Xt.CLIENT),console.log("%c 响应事件-用户输入音频的asr文本（异步返回）："+o.transcript,"color: green");break;case Cn:this.addAudioTextToList(this.responseId,o.delta,Xt.SERVER);break;case wn:break;case xn:this.addAudioVideoToList(this.responseId,o.delta,Xt.SERVER),this.resFinished=!1,console.log("%c 响应事件-返回模型音频（delta 是一个 mp3 格式base64 编码的音频块）","color: green");break;case _n:this.updateResponsStatus(this.responseId,rn),this.resFinished=!0,console.log("%c 响应事件-结束回复（status字段表示response的状态completed, cancelled分别对应完成、取消）","color: green");break;case On:this.updateResponsStatus(this.responseId,ln),o.error&&"1220"===o.error.code&&this.$message.error(null==(n=o.error)?void 0:n.message),console.log("%c 响应事件-发生错误"+e,"color: red")}}catch(o){console.log("---handleWsResponse-error---:",o)}},vadStatus(e){e&&(this.resFinished||this.vadType!==en||this.sendResponseCancel(),jn.emit("onStopAudio"))},listenAudioData(e){return c(this,null,(function*(){if(e&&e.size>0){const t=yield Kt(e);this.pushAudioData(t)}}))},audioData(e){return c(this,null,(function*(){e&&e.size>this.sendAudioLimit&&(this.currentAudioBlob=e,this.resFinished=!1,jn.emit("onStopAudio"),this.vadType===en&&this.sendCommit())}))},vedioData(e){e&&e.size>0&&(this.currentVideoBlob=new Blob([e],{type:"video/mp4"}))},videoImage(e){return c(this,null,(function*(){if(e&&e.size>0){const t=yield Kt(e);this.pushVideoData(t)}}))},addAudioVideoToList(e,t,n){if(n===Xt.SERVER){if(this.responseType===$t.TEXT)return;const o=this.messageList.findIndex((t=>t.id===e));if(-1!==o){const e=this.messageList[o];e.audioData.push({data:t}),this.messageList.splice(o,1,r({},e))}else this.messageList.push({id:e,type:n,responseType:this.responseType,answerStatus:sn,audioData:[{data:t}],textContent:[]}),this.scrollToBottom()}else t&&t.size>this.sendAudioLimit&&(this.messageList.push({id:e,type:n,videoUrlContent:this.currentVideoBlob?URL.createObjectURL(this.currentVideoBlob):null,audioUrl:URL.createObjectURL(t),textContent:[]}),this.currentVideoBlob=null,this.scrollToBottom(),console.log("---添加用户发送的音频到对话框--data?.size---:",null==t?void 0:t.size))},addAudioTextToList(e,t,n){if(!t)return;const o=this.messageList.findIndex((t=>t.id===e));if(-1!==o){const e=this.messageList[o];e.textContent.push(t),this.messageList.splice(o,1,r({},e))}else n===Xt.SERVER?this.messageList.push({id:e,type:n,responseType:this.responseType,answerStatus:sn,audioData:[],textContent:[t]}):this.messageList.push({id:e,type:n,audioUrl:"",textContent:[t]}),this.scrollToBottom()},updateResponsStatus(e,t){const n=this.messageList.findIndex((t=>t.id===e));if(-1!==n){const e=this.messageList[n];e.answerStatus=t,this.messageList.splice(n,1,r({},e))}},sendCommit(){const e={type:vn,client_timestamp:Date.now()};this.sendMessage(e),console.log("%c 推送事件-提交音频，标明说完话了。","color: green")},sendResponseCreate(){const e={type:yn,client_timestamp:Date.now()};this.sendMessage(e),console.log("%c 推送事件-创建模型回复","color: green")},sendResponseCancel(){const e={type:En,client_timestamp:Date.now()};this.sendMessage(e),console.log("%c 推送事件-取消模型调用","color: green")},sessionUpdate(){const e={event_id:"evt_fakeId",type:un,session:this.panelParams};this.sendMessage(e),console.log("%c 推送事件-设置会话信息"+JSON.stringify(e),"color: green")},pushAudioData(e){const t={type:pn,client_timestamp:Date.now(),audio:e};this.sendMessage(t)},pushVideoData(e){const t={type:fn,client_timestamp:Date.now(),video_frame:e};this.sendMessage(t)},sendMessage(e){this.sock&&this.isConnected&&this.sock.send(JSON.stringify(e))},firstOpenMedia(e){e===Zt.AUDIO?this.$refs.refToolBar.handleAudio():this.openVideoOrScreen(e)},openVideoOrScreen(e){this.videoType=e,this.enableVideo=!0},clearAndConnect(){this.isFirstOpenMedia=!0,this.clearObjectURL(),this.messageList=[],this.openWS()},openVideoOrScreenSuccess(){this.$refs.refToolBar.openVideoOrScreenSuccess()},videoTrackEnded(){this.$refs.refToolBar.closeVideoOrScreen()},audioPermisError(){this.$message.error("请检查音频权限是否已打开！"),this.$refs.refToolBar.closeVideoOrScreen(),this.enableAudio=!1,this.closeWS()},openVideoError(){this.$message.error("请检查视频权限是否已打开！"),this.handlePermisError()},openScreenError(){this.handlePermisError()},handlePermisError(){this.$refs.refToolBar.closeVideoOrScreen(),this.enableAudio||this.closeWS()},clearObjectURL(){Array.isArray(this.messageList)&&this.messageList.forEach((e=>{e.audioUrl&&URL.revokeObjectURL(e.audioUrl),e.videoUrlContent&&URL.revokeObjectURL(e.videoUrlContent)}))},loopScrollToBotton(){this.$refs.refMessageBox.loopScrollToBotton()},scrollToBottom(){this.$refs.refMessageBox.scrollToBottom()}},beforeDestroy(){this.clearObjectURL(),this.closeWS()},components:{MessageBox:to,ToolBar:uo,OperatorPanel:Po}},[["render",function(e,t,n,o,s,i){const a=d("MessageBox"),r=d("ToolBar"),l=d("OperatorPanel");return u(),x("div",Lo,[t[4]||(t[4]=O("div",{class:"experience__header flex flex-between"},[O("h3",null,"互动体验")],-1)),O("div",ko,[O("div",Uo,[L(a,{ref:"refMessageBox",class:B({"show-tool-bar":s.isShowToolBar}),messageList:s.messageList,isConnecting:s.isConnecting,isShowWelcome:!s.isShowToolBar,onOnClickMedia:i.clickMedia},null,8,["class","messageList","isConnecting","isShowWelcome","onOnClickMedia"]),R(L(r,{ref:"refToolBar",isConnected:s.isConnected,vadType:s.vadType,enableVideo:s.enableVideo,onOnPermissionError:i.audioPermisError,onOnOpenVideoOrScreen:i.openVideoOrScreen,onOnCloseVideoOrScreen:t[0]||(t[0]=e=>s.enableVideo=!1),onOnDisconnect:i.closeWS,onOnClearAndConnect:i.clearAndConnect,onOnAudioData:i.audioData,onOnListenAudioData:i.listenAudioData,onOnVadStatus:i.vadStatus,onOnOpenAudio:t[1]||(t[1]=e=>s.enableAudio=!0),onOnCloseAudio:t[2]||(t[2]=e=>s.enableAudio=!1)},null,8,["isConnected","vadType","enableVideo","onOnPermissionError","onOnOpenVideoOrScreen","onOnDisconnect","onOnClearAndConnect","onOnAudioData","onOnListenAudioData","onOnVadStatus"]),[[I,s.isShowToolBar]])]),L(l,{panelParams:s.panelParams,isConnected:s.isConnected,enableVideo:s.enableVideo,videoType:s.videoType,onOnOpenVideoSuccess:i.openVideoOrScreenSuccess,onOnOpenVideoError:i.openVideoError,onOnOpenScreenSuccess:i.openVideoOrScreenSuccess,onOnOpenScreenError:i.openScreenError,onOnVideoImage:i.videoImage,onOnVideoData:i.vedioData,onOnVideoTrackEnded:i.videoTrackEnded,onOnResponseTypeChange:i.responseTypeChange,onOnApiKeyChange:t[3]||(t[3]=e=>s.apiKey=e)},null,8,["panelParams","isConnected","enableVideo","videoType","onOnOpenVideoSuccess","onOnOpenVideoError","onOnOpenScreenSuccess","onOnOpenScreenError","onOnVideoImage","onOnVideoData","onOnVideoTrackEnded","onOnResponseTypeChange"])])])}],["__scopeId","data-v-4cbd5cfb"]])}],Qo=function(e){const t=$e(e.routes,e),n=e.parseQuery||at,o=e.stringifyQuery||rt,s=e.history,i=ft(),a=ft(),r=ft(),l=p(Ae);let c=Ae;H&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=K.bind(null,(e=>""+e)),u=K.bind(null,pe),h=K.bind(null,fe);function v(e,i){if(i=z({},i||l.value),"string"==typeof e){const o=ge(n,e,i.path),a=t.resolve({path:o.path},i),r=s.createHref(o.fullPath);return z(o,a,{params:h(a.params),hash:fe(o.hash),redirectedFrom:void 0,href:r})}let a;if(null!=e.path)a=z({},e,{path:ge(n,e.path,i.path).path});else{const t=z({},e.params);for(const e in t)null==t[e]&&delete t[e];a=z({},e,{params:u(t)}),i.params=u(i.params)}const r=t.resolve(a,i),c=e.hash||"";r.params=d(h(r.params));const p=function(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}(o,z({},e,{hash:(f=c,ue(f).replace(re,"{").replace(ce,"}").replace(ie,"^")),path:r.path}));var f;const m=s.createHref(p);return z({fullPath:p,hash:c,query:o===rt?lt(e.query):e.query||{}},r,{redirectedFrom:void 0,href:m})}function S(e){return"string"==typeof e?ge(n,e,l.value.path):z({},e)}function y(e,t){if(c!==e)return Ye(8,{from:t,to:e})}function E(e){return A(e)}function b(e){const t=e.matched[e.matched.length-1];if(t&&t.redirect){const{redirect:n}=t;let o="function"==typeof n?n(e):n;return"string"==typeof o&&(o=o.includes("?")||o.includes("#")?o=S(o):{path:o},o.params={}),z({query:e.query,hash:e.hash,params:null!=o.path?{}:e.params},o)}}function A(e,t){const n=c=v(e),s=l.value,i=e.state,a=e.force,r=!0===e.replace,d=b(n);if(d)return A(z(S(d),{state:"object"==typeof d?z({},i,d.state):i,force:a,replace:r}),t||n);const u=n;let h;return u.redirectedFrom=t,!a&&function(e,t,n){const o=t.matched.length-1,s=n.matched.length-1;return o>-1&&o===s&&Se(t.matched[o],n.matched[s])&&ye(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}(o,s,n)&&(h=Ye(16,{to:u,from:s}),P(s,s,!0,!1)),(h?Promise.resolve(h):x(u,s)).catch((e=>je(e)?je(e,2)?e:M(e):V(e,u,s))).then((e=>{if(e){if(je(e,2))return A(z({replace:r},S(e.to),{state:"object"==typeof e.to?z({},i,e.to.state):i,force:a}),t||u)}else e=O(u,s,!0,r,i);return _(u,s,e),e}))}function C(e,t){const n=y(e,t);return n?Promise.reject(n):Promise.resolve()}function w(e){const t=U.values().next().value;return t&&"function"==typeof t.runWithContext?t.runWithContext(e):e()}function x(e,t){let n;const[o,s,r]=function(e,t){const n=[],o=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let a=0;a<i;a++){const i=t.matched[a];i&&(e.matched.find((e=>Se(e,i)))?o.push(i):n.push(i));const r=e.matched[a];r&&(t.matched.find((e=>Se(e,r)))||s.push(r))}return[n,o,s]}(e,t);n=gt(o.reverse(),"beforeRouteLeave",e,t);for(const i of o)i.leaveGuards.forEach((o=>{n.push(mt(o,e,t))}));const l=C.bind(null,e,t);return n.push(l),Q(n).then((()=>{n=[];for(const o of i.list())n.push(mt(o,e,t));return n.push(l),Q(n)})).then((()=>{n=gt(s,"beforeRouteUpdate",e,t);for(const o of s)o.updateGuards.forEach((o=>{n.push(mt(o,e,t))}));return n.push(l),Q(n)})).then((()=>{n=[];for(const o of r)if(o.beforeEnter)if(J(o.beforeEnter))for(const s of o.beforeEnter)n.push(mt(s,e,t));else n.push(mt(o.beforeEnter,e,t));return n.push(l),Q(n)})).then((()=>(e.matched.forEach((e=>e.enterCallbacks={})),n=gt(r,"beforeRouteEnter",e,t,w),n.push(l),Q(n)))).then((()=>{n=[];for(const o of a.list())n.push(mt(o,e,t));return n.push(l),Q(n)})).catch((e=>je(e,8)?e:Promise.reject(e)))}function _(e,t,n){r.list().forEach((o=>w((()=>o(e,t,n)))))}function O(e,t,n,o,i){const a=y(e,t);if(a)return a;const r=t===Ae,c=H?history.state:{};n&&(o||r?s.replace(e.fullPath,z({scroll:r&&c&&c.scroll},i)):s.push(e.fullPath,i)),l.value=e,P(e,t,n,r),M()}let R;function I(){R||(R=s.listen(((e,t,n)=>{if(!N.listening)return;const o=v(e),i=b(o);if(i)return void A(z(i,{replace:!0,force:!0}),o).catch(q);c=o;const a=l.value;var r,d;H&&(r=Te(a.fullPath,n.delta),d=Be(),Ve.set(r,d)),x(o,a).catch((e=>je(e,12)?e:je(e,2)?(A(z(S(e.to),{force:!0}),o).then((e=>{je(e,20)&&!n.delta&&n.type===Ce.pop&&s.go(-1,!1)})).catch(q),Promise.reject()):(n.delta&&s.go(-n.delta,!1),V(e,o,a)))).then((e=>{(e=e||O(o,a,!1))&&(n.delta&&!je(e,8)?s.go(-n.delta,!1):n.type===Ce.pop&&je(e,20)&&s.go(-1,!1)),_(o,a,e)})).catch(q)})))}let B,D=ft(),T=ft();function V(e,t,n){M(e);const o=T.list();return o.length?o.forEach((o=>o(e,t,n))):console.error(e),Promise.reject(e)}function M(e){return B||(B=!e,I(),D.list().forEach((([t,n])=>e?n(e):t())),D.reset()),e}function P(t,n,o,s){const{scrollBehavior:i}=e;if(!H||!i)return Promise.resolve();const a=!o&&function(e){const t=Ve.get(e);return Ve.delete(e),t}(Te(t.fullPath,0))||(s||!o)&&history.state&&history.state.scroll||null;return g().then((()=>i(t,n,a))).then((e=>e&&De(e))).catch((e=>V(e,t,n)))}const L=e=>s.go(e);let k;const U=new Set,N={currentRoute:l,listening:!0,addRoute:function(e,n){let o,s;return ke(e)?(o=t.getRecordMatcher(e),s=n):s=e,t.addRoute(s,o)},removeRoute:function(e){const n=t.getRecordMatcher(e);n&&t.removeRoute(n)},clearRoutes:t.clearRoutes,hasRoute:function(e){return!!t.getRecordMatcher(e)},getRoutes:function(){return t.getRoutes().map((e=>e.record))},resolve:v,options:e,push:E,replace:function(e){return E(z(S(e),{replace:!0}))},go:L,back:()=>L(-1),forward:()=>L(1),beforeEach:i.add,beforeResolve:a.add,afterEach:r.add,onError:T.add,isReady:function(){return B&&l.value!==Ae?Promise.resolve():new Promise(((e,t)=>{D.add([e,t])}))},install(e){e.component("RouterLink",St),e.component("RouterView",At),e.config.globalProperties.$router=this,Object.defineProperty(e.config.globalProperties,"$route",{enumerable:!0,get:()=>f(l)}),H&&!k&&l.value===Ae&&(k=!0,E(s.location).catch((e=>{})));const t={};for(const o in Ae)Object.defineProperty(t,o,{get:()=>l.value[o],enumerable:!0});e.provide(ut,this),e.provide(ht,m(t)),e.provide(pt,l);const n=e.unmount;U.add(e),e.unmount=function(){U.delete(e),U.size<1&&(c=Ae,R&&R(),R=null,l.value=Ae,k=!1,B=!1),n()}}};function Q(e){return e.reduce(((e,t)=>e.then((()=>w(t)))),Promise.resolve())}return N}({history:function(e){const t=Le(e=Oe(e)),n=function(e,t,n,o){let s=[],i=[],a=null;const r=({state:i})=>{const r=Me(e,location),l=n.value,c=t.value;let d=0;if(i){if(n.value=r,t.value=i,a&&a===l)return void(a=null);d=c?i.position-c.position:0}else o(r);s.forEach((e=>{e(n.value,l,{delta:d,type:Ce.pop,direction:d?d>0?xe.forward:xe.back:xe.unknown})}))};function l(){const{history:e}=window;e.state&&e.replaceState(z({},e.state,{scroll:Be()}),"")}return window.addEventListener("popstate",r),window.addEventListener("beforeunload",l,{passive:!0}),{pauseListeners:function(){a=n.value},listen:function(e){s.push(e);const t=()=>{const t=s.indexOf(e);t>-1&&s.splice(t,1)};return i.push(t),t},destroy:function(){for(const e of i)e();i=[],window.removeEventListener("popstate",r),window.removeEventListener("beforeunload",l)}}}(e,t.state,t.location,t.replace),o=z({location:"",base:e,go:function(e,t=!0){t||n.pauseListeners(),history.go(e)},createHref:Ie.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}("/app/"),routes:No});window.Vue={createApp:N,version:"3.x"};const Yo=N(W);Yo.use(j),Yo.use(Qo),window.__VUE_APP_READY=!0,Yo.mount("#app");
